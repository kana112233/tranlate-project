ï¼ƒå¦‚ä½•ä½¿ç”¨æä¾›çš„å·¥å…·æ¥è®­ç»ƒTesseract 4.00


**å¯¹åŸ¹è®­è¿‡ç¨‹æœ‰ç–‘é—®ï¼Ÿ**å¦‚æœæ‚¨åœ¨åŸ¹è®­æœŸé—´é‡åˆ°ä¸€äº›é—®é¢˜

åŸ¹è®­è¿‡ç¨‹ä¸­ä½ éœ€è¦å¸®åŠ©ï¼Œä½¿ç”¨

[çš„tesseract-OCR(https://groups.google.com/forum/#!forum/tesseract-ocr)

é‚®ä»¶åˆ—è¡¨ï¼Œè¯¢é—®æ‚¨çš„é—®é¢˜ã€‚ 
**è¯·ä¸è¦**æŠ¥å‘Šæ‚¨çš„é—®é¢˜å’Œ

æå‡ºæœ‰å…³åŸ¹è®­çš„é—®é¢˜

[é—®é¢˜](https://github.com/tesseract-ocr/tesseract/issues)ï¼


* [ç®€ä»‹](TrainingTesseract-4.00.mdï¼ƒintroduction)
Â Â Â 
* [å¼€å§‹ä¹‹å‰](TrainingTesseract-4.00.mdï¼ƒåœ¨ä½ å¼€å§‹ä¹‹å‰)
Â Â Â 
* [éœ€è¦é¢å¤–çš„åº“](TrainingTesseract-4.00.mdï¼ƒadditional-libraries-required)
Â Â Â 
* [æ„å»ºåŸ¹è®­å·¥å…·](TrainingTesseract-4.00.mdï¼ƒbuilding-the-training-tools)
Â Â Â 
* [ç¡¬ä»¶ - è½¯ä»¶è¦æ±‚](TrainingTesseract-4.00.mdï¼ƒhardware-software-requirements)
Â Â Â 
* [åŸ¹è®­æ–‡æœ¬è¦æ±‚](TrainingTesseract-4.00.mdï¼ƒtraining-text-requirements)
Â Â Â 
* [åŸ¹è®­è¿‡ç¨‹æ¦‚è¿°](TrainingTesseract-4.00.mdï¼ƒoverview-of-training-process)
Â Â Â 
* [äº†è§£åŸ¹è®­æœŸé—´ä½¿ç”¨çš„å„ç§æ–‡ä»¶](TrainingTesseract-4.00.mdï¼ƒunderstanding-the-various-files-used-training-training)
Â Â Â 
* [LSTMTrainingå‘½ä»¤è¡Œ](TrainingTesseract-4.00.md #lstmtraining-command-line)
Â Â Â Â Â Â 
* [Unicharset Compression-recoding](TrainingTesseract-4.00.md #unicharset-compression-recoding)
Â Â Â Â Â Â 
* [éšæœºè®­ç»ƒæ•°æ®å’Œé¡ºåºè®­ç»ƒ](TrainingTesseract-4.00.md #sendomized-training-data-and-sequential_training)
Â Â Â Â Â Â 
* [å‹å·è¾“å‡º](TrainingTesseract-4.00.md #model-output)
Â Â Â Â Â Â 
* [ç½‘ç»œæ¨¡å¼å’Œä¼˜åŒ–](TrainingTesseract-4.00.md #net-mode-and-optimization)
Â Â Â Â Â Â 
* [å®Œç¾æ ·æœ¬å»¶è¿Ÿ](TrainingTesseract-4.00.mdï¼ƒperfect-sample-delay)
Â Â Â Â Â Â 
* [è°ƒè¯•é—´éš”å’Œå¯è§†è°ƒè¯•](TrainingTesseract-4.00.mdï¼ƒdebug-interval-and-visual-debugging)
Â Â Â 
* [TessTutorial](TrainingTesseract-4.00.md #stsstutorial)
Â Â Â Â Â Â 
* [TessTutorialçš„ä¸€æ¬¡æ€§è®¾ç½®](TrainingTesseract-4.00.mdï¼ƒone-time-setup-for-tesstutorial)
Â Â Â Â Â Â 
* [åˆ›å»ºåŸ¹è®­æ•°æ®](TrainingTesseract-4.00.md #creating-training-data)
Â Â Â Â Â Â Â Â Â 
* [åˆ¶ä½œç›’å­æ–‡ä»¶](TrainingTesseract-4.00.mdï¼ƒåˆ¶ä½œç›’å­æ–‡ä»¶)
Â Â Â Â Â Â Â Â Â 
* [ä½¿ç”¨tesstrain.sh](TrainingTesseract-4.00.mdï¼ƒusing-tesstrainsh)
Â Â Â Â Â Â 
* [lstmtrainingæ•™ç¨‹æŒ‡å—](TrainingTesseract-4.00.mdï¼ƒtutorial-guide-to-lstmtraining)
Â Â Â Â Â Â Â Â Â 
* [åˆ›å»ºStarter Traineddata](TrainingTesseract-4.00.mdï¼ƒcreating-starter-traineddata)
Â Â Â Â Â Â Â Â Â 
* [ä»é›¶å¼€å§‹è®­ç»ƒ](TrainingTesseract-4.00.mdï¼ƒtraining-from-scratch)
Â Â Â Â Â Â Â Â Â 
* [å½±å“å¾®è°ƒ](TrainingTesseract-4.00.mdï¼ƒfine-tuning-for-impact)
Â Â Â Â Â Â Â Â Â 
* [å¾®è°ƒå‡ ä¸ªå­—ç¬¦](TrainingTesseract-4.00.mdï¼ƒå¾®è°ƒå‡ ä¸ªå­—ç¬¦)
Â Â Â Â Â Â Â Â Â 
* [è®­ç»ƒå‡ å±‚](TrainingTesseract-4.00.md #training-just-a-few-layers)
Â Â Â Â Â Â 
* [æ¥è‡ªåŸ¹è®­çš„é”™è¯¯æ¶ˆæ¯](TrainingTesseract-4.00.md #error-messages-from-training)
Â Â Â 
* [ç»„åˆè¾“å‡ºæ–‡ä»¶](TrainingTesseract-4.00.mdï¼ƒcombined-the-output-files)
Â Â Â 
* [å¹»è§‰æ•ˆæœ](TrainingTesseract-4.00.mdï¼ƒthe-hallucination-effect)


ï¼ƒ ä»‹ç»


Tesseract 4.00åŒ…æ‹¬ä¸€ä¸ªæ–°çš„åŸºäºç¥ç»ç½‘ç»œçš„è¯†åˆ«å¼•æ“

æä¾›æ¯”ä»¥å‰æ›´é«˜çš„å‡†ç¡®åº¦(åœ¨æ–‡æ¡£å›¾åƒä¸Š)

ç‰ˆæœ¬ï¼Œä»¥æ¢å–æ‰€éœ€è®¡ç®—èƒ½åŠ›çš„æ˜¾ç€å¢åŠ ã€‚
ä¸Š

ç„¶è€Œï¼Œå¤æ‚çš„è¯­è¨€å®é™…ä¸Šå¯èƒ½æ¯”åŸºç¡€Tesseractå¿«*ã€‚


ç¥ç»ç½‘ç»œéœ€è¦æ›´å¤šçš„è®­ç»ƒæ•°æ®å’Œè®­ç»ƒ*å¾ˆå¤š*

æ¯”åŸºç¡€Tesseractæ…¢ã€‚
å¯¹äºåŸºäºæ‹‰ä¸è¯­çš„è¯­è¨€ï¼Œç°æœ‰çš„æ¨¡å‹æ•°æ®

æ‰€æä¾›çš„å·²ç»æ¥å—è¿‡çº¦400,000æ¡æ–‡æœ¬çº¿çš„åŸ¹è®­

å­—ä½“](https://github.com/tesseract-ocr/tesseract/issues/654#issuecomment-274574951)ã€‚

å¯¹äºå…¶ä»–è„šæœ¬ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šå­—ä½“å¯ç”¨ï¼Œä½†å®ƒä»¬ä»ç„¶å­˜åœ¨

è®­ç»ƒè¿‡ç±»ä¼¼æ•°é‡çš„æ–‡æœ¬ã€‚
è€Œä¸æ˜¯èŠ±å‡ åˆ†é’Ÿæ¥

å‡ ä¸ªå°æ—¶çš„è®­ç»ƒï¼ŒTesseract 4.00éœ€è¦å‡ ä¸ª*å¤©*åˆ°å‡ ä¸ª

*å‘¨ã€‚*å³ä½¿æœ‰äº†æ‰€æœ‰è¿™äº›æ–°çš„åŸ¹è®­æ•°æ®ï¼Œæ‚¨ä¹Ÿå¯èƒ½è§‰å¾—å®ƒä¸é€‚åˆ

ä½ çš„ç‰¹æ®Šé—®é¢˜ï¼Œå› æ­¤ä½ åœ¨è¿™é‡Œæƒ³é‡æ–°è®­ç»ƒå®ƒã€‚


åŸ¹è®­æœ‰å¤šç§é€‰æ‹©ï¼š


*   å¾®è°ƒã€‚
ä»ç°æœ‰çš„è®­ç»ƒæœ‰ç´ çš„è¯­è¨€å¼€å§‹ï¼Œè®­ç»ƒä½ çš„
Â Â Â Â 
å…·ä½“çš„é™„åŠ æ•°æ®ã€‚
è¿™å¯èƒ½é€‚ç”¨äºæ¥è¿‘çš„é—®é¢˜
Â Â Â Â 
ç°æœ‰çš„è®­ç»ƒæ•°æ®ï¼Œä½†æœ‰äº›å¾®å¦™çš„æ–¹å¼ä¸åŒï¼Œå¦‚a
Â Â Â Â 
ç‰¹åˆ«ä¸å¯»å¸¸çš„å­—ä½“
ç”šè‡³å¯ä»¥è¿›è¡Œå°‘é‡åŸ¹è®­
Â Â Â Â 
æ•°æ®ã€‚

*ä»ç½‘ç»œä¸­åˆ‡æ‰é¡¶å±‚(æˆ–ä¸€äº›ä»»æ„æ•°é‡çš„å±‚)
Â Â Â Â 
å¹¶ä½¿ç”¨æ–°æ•°æ®é‡æ–°è®­ç»ƒæ–°çš„é¡¶å±‚ã€‚
å¦‚æœå¾®è°ƒä¸èµ·ä½œç”¨ï¼Œ
Â Â Â Â 
è¿™å¾ˆå¯èƒ½æ˜¯ä¸‹ä¸€ä¸ªæœ€ä½³é€‰æ‹©ã€‚
åˆ‡æ‰é¡¶å±‚å¯ä»¥
Â Â Â Â 
å¦‚æœä½ å¼€å§‹ï¼Œä»ç„¶å¯ä»¥è®­ç»ƒä¸€ç§å…¨æ–°çš„è¯­è¨€æˆ–è„šæœ¬
Â Â Â Â 
ä¸æœ€ç›¸ä¼¼çš„å¤–è§‚è„šæœ¬ã€‚

*ä»å¤´å¼€å§‹ã€‚
è¿™æ˜¯ä¸€é¡¹è‰°å·¨çš„ä»»åŠ¡ï¼Œé™¤éä½ æœ‰ä¸€ä¸ªéå¸¸å¥½çš„ä»»åŠ¡
Â Â Â Â 
é’ˆå¯¹æ‚¨çš„é—®é¢˜çš„ä»£è¡¨æ€§å’Œè¶³å¤Ÿå¤§çš„åŸ¹è®­ã€‚
å¦‚æœä¸ï¼Œ
Â Â Â Â 
ä½ å¯èƒ½æœ€ç»ˆå¾—åˆ°ä¸€ä¸ªéå¸¸å¥½çš„è¿‡åº¦æ‹Ÿåˆçš„ç½‘ç»œ
Â Â Â Â 
å…³äºè®­ç»ƒæ•°æ®ï¼Œä½†ä¸æ˜¯å…³äºå®é™…æ•°æ®ã€‚


è™½ç„¶ä¸Šè¿°é€‰é¡¹å¯èƒ½å¬èµ·æ¥ä¸åŒï¼Œä½†å®é™…ä¸Šæ˜¯è®­ç»ƒæ­¥éª¤

å‡ ä¹å®Œå…¨ç›¸åŒï¼Œé™¤äº†å‘½ä»¤è¡Œï¼Œæ‰€ä»¥å®ƒç›¸å¯¹å®¹æ˜“å°è¯•

å®ƒæ˜¯æ‰€æœ‰æ–¹å¼ï¼Œç»™å®šæ—¶é—´æˆ–ç¡¬ä»¶å¹¶è¡Œè¿è¡Œå®ƒä»¬ã€‚


è‡³å°‘4.00ï¼Œæ—§çš„è¯†åˆ«å¼•æ“ä»ç„¶å­˜åœ¨ï¼Œä¹Ÿå¯ä»¥

ç»è¿‡åŸ¹è®­ï¼Œä½†å·²å¼ƒç”¨ï¼Œé™¤éæœ‰å……åˆ†ç†ç”±ä¿ç•™ï¼Œå¦åˆ™å¯ä»¥

å°†æ¥çš„ç‰ˆæœ¬ä¸­åˆ é™¤ã€‚


ï¼ƒ åœ¨ä½ å¼€å§‹ä¹‹å‰


ä½ ä¸éœ€è¦ç¥ç»ç½‘ç»œçš„ä»»ä½•èƒŒæ™¯æ¥è®­ç»ƒTesseract 4.00ï¼Œä½†å®ƒ

å¯èƒ½æœ‰åŠ©äºç†è§£åŸ¹è®­é€‰é¡¹ä¹‹é—´çš„å·®å¼‚ã€‚
è¯·

åœ¨é’»ç ”ä¹‹å‰é˜…è¯»[å®æ–½ä»‹ç»](NeuralNetsInTesseract4.00)

æ·±å…¥åŸ¹è®­è¿‡ç¨‹ï¼Œä»¥åŠä¸åŸ¹è®­ç›¸åŒçš„æ³¨æ„äº‹é¡¹

Tesseract 3.04é€‚ç”¨ï¼š


**é‡è¦è¯´æ˜**ï¼šåœ¨æ‚¨èŠ±è´¹æ—¶é—´å’Œç²¾åŠ›åŸ¹è®­Tesseractä¹‹å‰ï¼Œå®ƒ

å¼ºçƒˆå»ºè®®æ‚¨é˜…è¯»[ImproveQuality](ImproveQuality)é¡µé¢ã€‚


ï¼ƒéœ€è¦é¢å¤–çš„åº“


ä»3.03å¼€å§‹ï¼Œéœ€è¦é¢å¤–çš„åº“æ¥æ„å»ºåŸ¹è®­

å·¥å…·ã€‚


```
sudo apt-get install libicu-dev
sudo apt-get install libpango1.0-dev
sudo apt-get install libcairo2-dev
```

ï¼ƒæ„å»ºåŸ¹è®­å·¥å…·


ä»3.03å¼€å§‹ï¼Œå¦‚æœæ‚¨è¦ä»æºä»£ç ç¼–è¯‘Tesseractï¼Œåˆ™éœ€è¦è¿›è¡Œç¼–è¯‘

å¹¶ä½¿ç”¨å•ç‹¬çš„makeå‘½ä»¤å®‰è£…åŸ¹è®­å·¥å…·ã€‚
ä¸€æ—¦ä¸Šè¿°

å·²å®‰è£…å…¶ä»–åº“ï¼Œä»Tesseractè¿è¡Œä»¥ä¸‹å‘½ä»¤

æºç›®å½•ï¼š


```
make
make training
sudo make training-install
```

æ„å»º[ScrollView.jar](ViewerDebugging)ä¹Ÿå¾ˆæœ‰ç”¨ï¼Œä½†ä¸æ˜¯å¿…éœ€çš„ï¼š


```
make ScrollView.jar
export SCROLLVIEW_PATH=$PWD/java
```

ï¼ƒç¡¬ä»¶ - è½¯ä»¶è¦æ±‚


åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼ŒåŸ¹è®­ä»…é€‚ç”¨äºLinuxã€‚ 
(macOSå‡ ä¹å¯ä»¥å·¥ä½œ;å®ƒéœ€è¦

å¯¹shellè„šæœ¬è¿›è¡Œè½»å¾®æ”»å‡»ä»¥è§£é‡Šæ—§ç‰ˆæœ¬çš„â€œbashâ€å§

åœ¨`mktemp`ä¸­æä¾›å’ŒåŒºåˆ«ã€‚)Windowsæ˜¯æœªçŸ¥çš„ï¼Œä½†éœ€è¦msysæˆ–Cygwinã€‚


è‡³äºè¿è¡ŒTesseract 4.0.0ï¼Œå®ƒæ˜¯æœ‰ç”¨çš„ï¼Œä½†ä¸æ˜¯å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªå¤šæ ¸(4æ˜¯å¥½çš„)

æœºå™¨ï¼ŒOpenMPå’ŒIntel Intrinsicsæ”¯æŒSSE / AVXæ‰©å±•ã€‚

åŸºæœ¬ä¸Šå®ƒä»ä¼šåœ¨å…·æœ‰è¶³å¤Ÿå†…å­˜çš„ä»»ä½•ä¸œè¥¿ä¸Šè¿è¡Œï¼Œä½†æ˜¯é«˜ç«¯è¿è¡Œ

ä½ çš„å¤„ç†å™¨è¶Šå¿«ã€‚
ä¸éœ€è¦GPUã€‚ 
(æ²¡æœ‰æ”¯æŒã€‚)è®°å¿†

useå¯ä»¥é€šè¿‡--max_image_MBå‘½ä»¤è¡Œé€‰é¡¹æ§åˆ¶ï¼Œä½†ä½ æ˜¯

å¯èƒ½éœ€è¦è‡³å°‘1GBçš„å†…å­˜ï¼Œè¶…è¿‡æ‚¨çš„æ“ä½œç³»ç»Ÿæ‰€å ç”¨çš„å†…å­˜ã€‚


ï¼ƒåŸ¹è®­æ–‡æœ¬è¦æ±‚


å¯¹äºåŸºäºæ‹‰ä¸è¯­çš„è¯­è¨€ï¼Œæä¾›çš„ç°æœ‰æ¨¡å‹æ•°æ®å·²ç»è¿‡åŸ¹è®­

çº¦[400000ä¸ªå­—ä½“è·¨è¶Šçº¦4500

å­—ä½“](https://github.com/tesseract-ocr/tesseract/issues/654#issuecomment-274574951)ã€‚

å¯¹äºå…¶ä»–è„šæœ¬ï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šå­—ä½“å¯ç”¨ï¼Œä½†å®ƒä»¬ä»ç„¶å­˜åœ¨

è®­ç»ƒè¿‡ç±»ä¼¼æ•°é‡çš„æ–‡æœ¬ã€‚


è¯·æ³¨æ„ï¼Œæ‹¥æœ‰æ›´å¤šåŸ¹è®­æ–‡æœ¬å¹¶åˆ¶ä½œæ›´å¤šé¡µé¢æ˜¯æœ‰ç›Šçš„

ä½†æ˜¯ï¼Œç”±äºç¥ç»ç½‘ç»œä¸èƒ½æ¦‚æ‹¬ï¼Œéœ€è¦å¯¹æŸäº›ä¸œè¥¿è¿›è¡Œè®­ç»ƒ

ç±»ä¼¼äºä»–ä»¬å°†è¦è¿è¡Œçš„ã€‚
å¦‚æœç›®æ ‡åŸŸä¸¥é‡

æœ‰é™çš„ï¼Œç„¶åæ‰€æœ‰å…³äºéœ€è¦å¤§é‡è®­ç»ƒæ•°æ®çš„å¯æ€•è­¦å‘Šå¯èƒ½ä¸ä¼š

é€‚ç”¨ï¼Œä½†å¯èƒ½éœ€è¦æ›´æ”¹ç½‘ç»œè§„èŒƒã€‚


ï¼ƒåŸ¹è®­æµç¨‹æ¦‚è¿°


æ•´ä¸ªåŸ¹è®­è¿‡ç¨‹ç±»ä¼¼äº[åŸ¹è®­3.04](TrainingTesseract)ã€‚


æ¦‚å¿µä¸Šç›¸åŒï¼š


1. [å‡†å¤‡åŸ¹è®­æ–‡æœ¬ã€‚](https://github.com/tesseract-ocr/tesseract/issues/654#issuecomment-274574951)

1.å°†æ–‡æœ¬æ¸²æŸ“åˆ°å›¾åƒ+æ¡†æ–‡ä»¶ã€‚ 
(æˆ–è€…ä¸ºç°æœ‰çš„åˆ›å»ºæ‰‹å·¥åˆ¶ä½œçš„ç›’å­æ–‡ä»¶
Â Â Â Â 
å›¾åƒæ•°æ®ã€‚)

1.åˆ¶ä½œunicharsetæ–‡ä»¶ã€‚ 
(å¯ä»¥éƒ¨åˆ†æŒ‡å®šï¼Œå³æ‰‹åŠ¨åˆ›å»º)ã€‚

1. [ä»unicharsetå’Œå¯é€‰å­—å…¸åˆ¶ä½œä¸€ä¸ªå…¥é—¨è®­ç»ƒæ•°æ®
Â Â Â Â Â 
æ•°æ®ã€‚](ï¼ƒåˆ›å»ºèµ·åŠ¨-traineddata)

1.è¿è¡Œtesseractå¤„ç†å›¾åƒ+æ¡†æ–‡ä»¶ä»¥è¿›è¡Œè®­ç»ƒæ•°æ®é›†ã€‚

1.è¿è¡ŒåŸ¹è®­æ•°æ®é›†åŸ¹è®­ã€‚

1.åˆå¹¶æ•°æ®æ–‡ä»¶ã€‚


å…³é”®çš„åŒºåˆ«æ˜¯ï¼š


*è¿™äº›æ¡†åªéœ€è¦åœ¨* textlineçº§åˆ«ã€‚*å› æ­¤*æ›´å®¹æ˜“*
Â Â Â Â 
ä»ç°æœ‰å›¾åƒæ•°æ®åˆ¶ä½œè®­ç»ƒæ•°æ®ã€‚

* .træ–‡ä»¶ç”±.lstmfæ•°æ®æ–‡ä»¶æ›¿æ¢ã€‚

*å­—ä½“*å¯ä»¥è€Œä¸”åº”è¯¥è‡ªç”±æ··åˆ*è€Œä¸æ˜¯åˆ†å¼€ã€‚

*æ›´æ¢èšç±»æ­¥éª¤(mtrarainingï¼Œcntrainingï¼Œshapeclustering)
Â Â Â Â 
åªéœ€ä¸€ä¸ªç¼“æ…¢çš„è®­ç»ƒæ­¥éª¤ã€‚


åŸ¹è®­ä¸èƒ½åƒ3.04åŸ¹è®­é‚£æ ·è‡ªåŠ¨åŒ–

åŸå› ï¼š


*æ…¢é€Ÿè®­ç»ƒæ­¥éª¤ä¸é€‚åˆä»è„šæœ¬ä¸­é—´è¿è¡Œ
Â Â Â Â 
å¦‚æœåœæ­¢å¯ä»¥é‡æ–°å¯åŠ¨ï¼Œå¹¶ä¸”å¾ˆéš¾è‡ªåŠ¨åˆ¤æ–­å®ƒæ˜¯ä»€ä¹ˆæ—¶å€™
Â Â Â Â 
å®Œäº†ã€‚

*å¦‚ä½•è®­ç»ƒç½‘ç»œæœ‰å¤šç§é€‰æ‹©(è§ä¸Šæ–‡)ã€‚

*å…è®¸è¯­è¨€æ¨¡å‹å’Œunicharsetä¸åŒ
Â Â Â Â 
ç”±åŸºåœ°Tesseractä½¿ç”¨ï¼Œä½†ä¸ä¸€å®šæ˜¯ã€‚

*æ²¡æœ‰å¿…è¦ä½¿ç”¨ä¸è¯­è¨€ç›¸åŒçš„åŸºç¡€Tesseract
Â Â Â Â 
ç¥ç»ç½‘ç»œTesseractã€‚


ï¼ƒäº†è§£åŸ¹è®­æœŸé—´ä½¿ç”¨çš„å„ç§æ–‡ä»¶


ä¸åŸºç¡€Tesseractä¸€æ ·ï¼Œå®Œæ•´çš„LSTMæ¨¡å‹ä»¥åŠå®ƒæ‰€éœ€çš„ä¸€åˆ‡éƒ½æ˜¯

æ”¶é›†åœ¨`traineddata`æ–‡ä»¶ä¸­ã€‚
ä¸åŸºç¡€Tesseractä¸åŒï¼Œå®ƒæ˜¯ä¸€ä¸ªâ€œé¦–å‘â€

trainingdata`æ–‡ä»¶åœ¨åŸ¹è®­æœŸé—´æä¾›ï¼Œå¿…é¡»æå‰è®¾ç½®ã€‚
å®ƒ

å¯ä»¥åŒ…å«ï¼š


*é…ç½®æ–‡ä»¶æä¾›æ§åˆ¶å‚æ•°ã€‚

* ** Unicharset **å®šä¹‰å­—ç¬¦é›†ã€‚

* ** Unicharcompressï¼Œ**åˆåç¼–ç å™¨ï¼Œå®ƒå°†unicharsetè¿›ä¸€æ­¥æ˜ å°„åˆ°
Â Â Â Â 
ç¥ç»ç½‘ç»œè¯†åˆ«å™¨å®é™…ä½¿ç”¨çš„ä»£ç ã€‚

*æ ‡ç‚¹ç¬¦å·æ¨¡å¼dawgï¼Œå…è®¸åœ¨å•è¯å‘¨å›´ä½¿ç”¨æ ‡ç‚¹ç¬¦å·ã€‚

* Word dawgã€‚
ç³»ç»Ÿå•è¯åˆ—è¡¨è¯­è¨€æ¨¡å‹ã€‚

*æ•°å­—dawgï¼Œå…è®¸çš„æ•°å­—æ¨¡å¼ã€‚


å¿…é¡»æä¾›å¤§èƒ†çš„å…ƒç´ **ã€‚
å…¶ä»–æ˜¯å¯é€‰çš„ï¼Œä½†å¦‚æœæœ‰ä»»ä½•ç‘•ç–µ

å¦‚æœæä¾›ï¼Œè¿˜å¿…é¡»æä¾›æ ‡ç‚¹ç¬¦å·ã€‚
ä¸€ä¸ªæ–°å·¥å…·ï¼š

æä¾›`combine_lang_model`æ¥ä»aåˆ›å»º`starter traineddata`

`unicharset`å’Œå¯é€‰å•è¯åˆ—è¡¨ã€‚


åœ¨åŸ¹è®­æœŸé—´ï¼ŒåŸ¹è®­å¸ˆä¼šç¼–å†™æ£€æŸ¥ç‚¹æ–‡ä»¶ï¼Œè¿™æ˜¯ä¸€ä¸ªæ ‡å‡†

ç¥ç»ç½‘ç»œè®­ç»ƒå‘˜çš„è¡Œä¸ºã€‚
è¿™æ ·å¯ä»¥åœæ­¢è®­ç»ƒ

å¦‚æœéœ€è¦ï¼Œç¨åå†ç»§ç»­ã€‚
ä»»ä½•æ£€æŸ¥ç‚¹éƒ½å¯ä»¥è½¬æ¢ä¸ºå®Œæ•´

`traineddata`ç”¨äºä½¿ç”¨`--stop_training`å‘½ä»¤è¡Œæ ‡å¿—è¿›è¡Œè¯†åˆ«ã€‚


åŸ¹è®­å¸ˆè¿˜ä¼šå®šæœŸå°†æ£€æŸ¥ç‚¹æ–‡ä»¶å†™å…¥æ–°çš„bests

åœ¨è®­ç»ƒä¸­ã€‚


å¯ä»¥ä¿®æ”¹ç½‘ç»œå¹¶é‡æ–°è®­ç»ƒå…¶ä¸­çš„ä¸€éƒ¨åˆ†æˆ–å¾®è°ƒ

é€šè¿‡å‘Šè¯‰ï¼Œè·å–ç‰¹å®šçš„è®­ç»ƒæ•°æ®(å³ä½¿æ˜¯ä¿®æ”¹è¿‡çš„unicharsetï¼)

è®­ç»ƒå‘˜å°†`--continue_from`ä½œä¸ºç°æœ‰çš„æ£€æŸ¥ç‚¹æ–‡ä»¶ï¼Œæˆ–è€…æ¥è‡ªè£¸ä½“

å·²ä»ç°æœ‰`traineddata`æ–‡ä»¶ä¸­æå–çš„LSTMæ¨¡å‹æ–‡ä»¶

ä½¿ç”¨`combine_tessdata` _æä¾›å®ƒå°šæœªè½¬æ¢ä¸ºæ•´æ•°._


å¦‚æœåœ¨`--traineddata`æ ‡å¿—ä¸­æ›´æ”¹äº†unicharsetï¼Œåˆ™ä¸ä¹‹ç›¸æ¯”

é€šè¿‡`--continue_from`æä¾›çš„æ¨¡å‹ä¸­ä½¿ç”¨çš„ï¼Œç„¶åæ˜¯

`--old_traineddata`æ ‡å¿—å¿…é¡»æä¾›ç›¸åº”çš„`traineddata`

ä¿å­˜`unicharset`å’Œ`rewderçš„æ–‡ä»¶ã€‚è¿™ä½¿è®­ç»ƒå¸ˆèƒ½å¤Ÿ

è®¡ç®—å­—ç¬¦é›†ä¹‹é—´çš„æ˜ å°„ã€‚


è®­ç»ƒæ•°æ®é€šè¿‡`.lstmf`æ–‡ä»¶æä¾›ï¼Œè¿™äº›æ–‡ä»¶æ˜¯åºåˆ—åŒ–çš„

`DocumentData`å®ƒä»¬åŒ…å«ä¸€ä¸ªå›¾åƒå’Œç›¸åº”çš„UTF8æ–‡æœ¬

è½¬å½•ï¼Œå¹¶å¯ä»¥ä½¿ç”¨Tesseractåœ¨tif / boxæ–‡ä»¶å¯¹ä¸­ç”Ÿæˆ

ç±»ä¼¼äºä¸ºæ—§å¼•æ“åˆ›å»º`.tr`æ–‡ä»¶çš„æ–¹å¼ã€‚


#LSTMTrainingå‘½ä»¤è¡Œ


è®­ç»ƒç¨‹åºæ˜¯ä¸€ç§ç”¨äºè®­ç»ƒç¥ç»ç½‘ç»œçš„å¤šåŠŸèƒ½å·¥å…·ã€‚

ä¸‹è¡¨æè¿°äº†å…¶å‘½ä»¤è¡Œé€‰é¡¹ï¼š


| 
**æ——å¸œ** | 
**è¾“å…¥** | 
**é»˜è®¤** | 
**è¯´æ˜** |

| 
ï¼š--------------------- | 
ï¼š------ï¼š| 
ï¼š---------ï¼š| 
ï¼š----------------- |

| 
`traineddata` | 
`string` |
æ²¡æœ‰|
å…¥é—¨è®­ç»ƒæ•°æ®æ–‡ä»¶çš„è·¯å¾„ï¼ŒåŒ…å«å•å­—ç¬¦ï¼Œé‡æ–°ç¼–ç å™¨å’Œå¯é€‰è¯­è¨€æ¨¡å‹ã€‚ 
|

| 
`net_spec` | 
`string` |
æ²¡æœ‰|
æŒ‡å®šç½‘ç»œçš„æ‹“æ‰‘ã€‚ 
|

| 
`model_output` | 
`string` |
æ²¡æœ‰|
è¾“å‡ºæ¨¡å‹æ–‡ä»¶/æ£€æŸ¥ç‚¹çš„åŸºæœ¬è·¯å¾„ã€‚ 
|

| 
`max_image_MB` | 
`int` | 
`6000` |
ç”¨äºç¼“å­˜å›¾åƒçš„æœ€å¤§å†…å­˜é‡ã€‚ 
| 
`learning_rate` | 
`double` | 
`10e-4` | 
SGDç®—æ³•çš„åˆå§‹å­¦ä¹ ç‡ã€‚ 
|

| 
`sequential_training` | 
`bool` | 
`false` |
è®¾ç½®ä¸ºtrueä»¥è¿›è¡Œé¡ºåºåŸ¹è®­ã€‚
é»˜è®¤æ˜¯ä»¥å¾ªç¯æ–¹å¼å¤„ç†æ‰€æœ‰è®­ç»ƒæ•°æ®ã€‚ 
|

| 
`net_mode` | 
`int` | 
`192` |
æ¥è‡ª`NetworkFlags`in`network.h`çš„æ ‡å¿—ã€‚
å¯èƒ½çš„å€¼ï¼š'128`ç”¨äºAdamä¼˜åŒ–è€Œä¸æ˜¯åŠ¨é‡; 
`64`å…è®¸ä¸åŒçš„å±‚æœ‰è‡ªå·±çš„å­¦ä¹ ç‡ï¼Œè‡ªåŠ¨å‘ç°ã€‚ 
|

| 
`perfect_sample_delay` | 
`int` | 
`0` |
å½“ç½‘ç»œå˜å¾—è‰¯å¥½æ—¶ï¼Œè‡ªä»å…è®¸æœ€åä¸€ä¸ªå®Œç¾çš„æ ·æœ¬ä»¥æ¥ï¼Œåœ¨çœ‹åˆ°è®¸å¤šä¸å®Œç¾çš„æ ·æœ¬ä¹‹åï¼Œåªèƒ½æä¾›å®Œç¾çš„æ ·æœ¬ã€‚ 
|

| 
`debug_interval` | 
`int` | 
`0` |
å¦‚æœéé›¶ï¼Œåˆ™æ¯éš”å¤šæ¬¡è¿­ä»£æ˜¾ç¤ºå¯è§†è°ƒè¯•ã€‚ 
|

| 
`weight_range` | 
`double` | 
`0.1` |
ç”¨äºåˆå§‹åŒ–æƒé‡çš„éšæœºå€¼èŒƒå›´ã€‚ 
|

| 
`åŠ¨é‡`| 
`double` | 
`0.5` | 
Î±å¹³æ»‘æ¸å˜çš„åŠ¨é‡ã€‚ 
|

| 
`adam_beta` | 
`double` | 
`0.999` | 
ADAMç®—æ³•ä¸­çš„å¹³æ»‘å› å­å¹³æ–¹æ¢¯åº¦ã€‚ 
|

| 
`max_iterations` | 
`int` | 
`0` |
ç»è¿‡å¤šæ¬¡è¿­ä»£ååœæ­¢è®­ç»ƒã€‚ 
|

| 
`target_error_rate` | 
`double` | 
`0.01` |
å¦‚æœå¹³å‡ç™¾åˆ†æ¯”é”™è¯¯ç‡ä½äºæ­¤å€¼ï¼Œè¯·åœæ­¢åŸ¹è®­ã€‚ 
|

| 
`continue_from` | 
`string` |
æ²¡æœ‰|
ä¸Šä¸€ä¸ªæ£€æŸ¥ç‚¹çš„è·¯å¾„ï¼Œå¯ä»¥ä»ä¸­ç»§ç»­è®­ç»ƒæˆ–å¾®è°ƒã€‚ 
|

| 
`stop_training` | 
`bool` | 
`false` |
å°†`--continue_from`ä¸­çš„è®­ç»ƒæ£€æŸ¥ç‚¹è½¬æ¢ä¸ºè¯†åˆ«æ¨¡å‹ã€‚ 
|

| 
`convert_to_int` | 
`bool` | 
`false` |
ä½¿ç”¨`stop_training`ï¼Œè½¬æ¢ä¸º8ä½æ•´æ•°ä»¥è·å¾—æ›´é«˜çš„é€Ÿåº¦ï¼Œç²¾åº¦ç¨å·®ã€‚ 
|

| 
`append_index` | 
`int` | 
`-1` |
åœ¨ç»™å®šçš„ç´¢å¼•å¤„åˆ‡æ–­ç½‘ç»œçš„å¤´éƒ¨å¹¶é™„åŠ `--net_spec`ç½‘ç»œä»£æ›¿åˆ‡æ–­éƒ¨åˆ†ã€‚ 
|

| 
`train_listfile` | 
`string` |
æ²¡æœ‰|
åˆ—å‡ºåŸ¹è®­æ•°æ®æ–‡ä»¶çš„æ–‡ä»¶çš„æ–‡ä»¶åã€‚ 
|

| 
`eval_listfile` | 
`string` |
æ²¡æœ‰|
åˆ—å‡ºè¯„ä¼°æ•°æ®æ–‡ä»¶çš„æ–‡ä»¶çš„æ–‡ä»¶åï¼Œè¯¥è¯„ä¼°æ•°æ®æ–‡ä»¶ç”¨äºç‹¬ç«‹äºè®­ç»ƒæ•°æ®è¯„ä¼°æ¨¡å‹ã€‚ 
|


å¤§å¤šæ•°æ ‡å¿—éƒ½ä½¿ç”¨é»˜è®¤å€¼ï¼Œåªæœ‰å‡ ä¸ªæ ‡å¿—éœ€è¦

ä¸‹é¢åˆ—å‡ºçš„ç‰¹å®šæ“ä½œï¼Œä½†é¦–å…ˆæ˜¯ä¸€äº›è¯¦ç»†çš„è¯„è®º

å¤æ‚çš„æ——å¸œï¼š


## Unicharset Compression-recoding


LSTMå¾ˆæ“…é•¿å­¦ä¹ åºåˆ—ï¼Œä½†æ˜¯å½“æ•°é‡å¾ˆå¤šæ—¶ï¼Œå®ƒä¼šå‡æ…¢å¾ˆå¤š*

å›½å®¶å¤ªå¤§äº†ã€‚
æœ‰å®è¯ç»“æœè¡¨æ˜å®ƒæ›´å¥½

è¦æ±‚LSTMå­¦ä¹ ä¸€ä¸ªé•¿åºåˆ—è€Œä¸æ˜¯å¾ˆå¤šç±»çš„çŸ­åºåˆ—ï¼Œæ‰€ä»¥

å¯¹äºå¤æ‚çš„è„šæœ¬(Hanï¼ŒHangulå’Œå°åº¦è¯­è„šæœ¬)ï¼Œæœ€å¥½æ˜¯

å°†æ¯ä¸ªç¬¦å·é‡æ–°ç¼–ç ä¸ºæ¥è‡ªå°‘æ•°ç±»çš„çŸ­åºåˆ—ä»£ç 

æ¯”æ‹¥æœ‰å¤§é‡çš„è¯¾ç¨‹ã€‚ 
`combine_lang_model`å‘½ä»¤æœ‰è¿™ä¸ª

é»˜è®¤æƒ…å†µä¸‹æ‰“å¼€åŠŸèƒ½ã€‚
å®ƒå°†æ¯ä¸ªæ±‰å­—ç¼–ç ä¸ºå¯å˜é•¿åº¦

1-5ä¸ªä»£ç çš„åºåˆ—ï¼ŒHangulä½¿ç”¨Jamoç¼–ç ä½œä¸º3ä¸ªä»£ç çš„åºåˆ—ï¼Œ

å’Œå…¶ä»–è„šæœ¬ä½œä¸ºå…¶unicodeç»„ä»¶çš„åºåˆ—ã€‚
å¯¹äºè„šæœ¬

ä½¿ç”¨_virama_å­—ç¬¦ç”Ÿæˆåˆå–è¾…éŸ³ï¼Œ(æ‰€æœ‰å°åº¦è¯­

è„šæœ¬åŠ ç¼…ç”¸å’Œé«˜æ£‰è¯­)å‡½æ•°`NormalizeCleanAndSegmentUTF8`

å°†viramaä¸é€‚å½“çš„é‚»å±…é…å¯¹ä»¥ç”Ÿæˆæ›´åŠ é¢å‘å­—å½¢çš„

åœ¨unicharsetç¼–ç ã€‚
ä¸ºäº†å……åˆ†åˆ©ç”¨è¿™ç§æ”¹è¿›ï¼Œ

åº”ä¸º`combine_lang_model`è®¾ç½®`--pass_through_recoder`æ ‡å¿—

è„šæœ¬ã€‚


##éšæœºè®­ç»ƒæ•°æ®å’Œé¡ºåºè®­ç»ƒ


ä¸ºäº†ä½¿éšæœºæ¢¯åº¦ä¸‹é™èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼Œå¯ä»¥ä½¿ç”¨è®­ç»ƒæ•°æ®

åœ¨æ‰€æœ‰æ ·æœ¬æ–‡ä»¶ä¸­éšæœºæ‹–æ›³ï¼Œä»¥ä¾¿æ•™ç»ƒå¯ä»¥é˜…è¯»å®ƒ

é¡ºä¾¿é€šè¿‡æ¯ä¸ªæ–‡ä»¶ï¼Œå½“å®ƒåˆ°è¾¾æ—¶è¿”å›åˆ°ç¬¬ä¸€ä¸ªæ–‡ä»¶

ç»“æŸã€‚
è¿™å®Œå…¨è¿èƒŒäº†TesseractåŸºç¡€è®­ç»ƒçš„æ–¹å¼ï¼


å¦‚æœä½¿ç”¨æ¸²æŸ“ä»£ç (é€šè¿‡`tesstrain.sh`)ï¼Œé‚£ä¹ˆå®ƒå°†éšæœºæ’­æ”¾

åœ¨æ¯ä¸ªæ–‡ä»¶ä¸­ç¤ºå‡ºæ–‡æœ¬è¡Œï¼Œä½†æ¯ä¸ªæ–‡ä»¶éƒ½ä¼šå¾—åˆ°ä¸€ç»„æ–‡ä»¶

åŒ…å«å•ä¸€å­—ä½“çš„è®­ç»ƒæ ·æœ¬ã€‚
è¦æ·»åŠ æ›´å‡åŒ€çš„æ··åˆï¼Œ

é»˜è®¤æ˜¯ä¾æ¬¡å¤„ç†æ¯ä¸ªæ–‡ä»¶ä¸­çš„ä¸€ä¸ªæ ·æœ¬ï¼Œå³'å¾ªç¯'æ ·å¼ã€‚

å¦‚æœæ‚¨ä»¥å…¶ä»–æ–¹å¼ç”Ÿæˆäº†è®­ç»ƒæ•°æ®ï¼Œæˆ–è€…å®ƒä»¬éƒ½æ˜¯ç›¸åŒçš„

é£æ ¼(ä¾‹å¦‚æ‰‹å†™çš„æ‰‹ç¨¿)ç„¶åä½ å¯ä»¥ä½¿ç”¨

`--sesttial_training`æ ‡å¿—ä¸º`lstmtrainingã€‚è¿™æ˜¯æ›´é«˜æ•ˆçš„å†…å­˜

å› ä¸ºå®ƒä¸€æ¬¡åªä»ä¸¤ä¸ªæ–‡ä»¶åŠ è½½æ•°æ®ï¼Œç„¶åå¤„ç†å®ƒä»¬

åºåˆ—ã€‚ 
(ç¬¬äºŒä¸ªæ–‡ä»¶æ˜¯é¢„è¯»çš„ï¼Œå› æ­¤åœ¨éœ€è¦æ—¶å°±å¯ä»¥ä½¿ç”¨äº†ã€‚)


##æ¨¡å‹è¾“å‡º


åŸ¹è®­å¸ˆä½¿ç”¨`--model_output`ä½œä¸ºåŸºæœ¬åç§°å®šæœŸä¿å­˜æ£€æŸ¥ç‚¹ã€‚

å› æ­¤ï¼Œå¯ä»¥åœ¨ä»»ä½•æ—¶å€™åœæ­¢è®­ç»ƒï¼Œå¹¶ä½¿ç”¨é‡æ–°å¯åŠ¨å®ƒ

ç›¸åŒçš„å‘½ä»¤è¡Œï¼Œå®ƒå°†ç»§ç»­ã€‚
è¦å¼ºåˆ¶é‡æ–°å¯åŠ¨ï¼Œè¯·ä½¿ç”¨å…¶ä»–æ–¹æ³•

`--model_output`æˆ–åˆ é™¤æ‰€æœ‰æ–‡ä»¶ã€‚


##ç½‘ç»œæ¨¡å¼å’Œä¼˜åŒ–


â€œ128â€æ ‡å¿—å¯ç”¨äº†Adamä¼˜åŒ–ï¼Œè¿™ä¼¼ä¹æ¯”å®ƒæ›´å¥½

å¹³æ·¡çš„æ°”åŠ¿ã€‚


`64`æ ‡å¿—å¯ç”¨è‡ªåŠ¨ç‰¹å®šäºå›¾å±‚çš„å­¦ä¹ é€Ÿç‡ã€‚
è¿›æ­¥æ—¶

æ‘Šä½ï¼ŒåŸ¹è®­å¸ˆè°ƒæŸ¥å“ªä¸€å±‚åº”è¯¥æœ‰ä»–ä»¬çš„å­¦ä¹ ç‡

ç‹¬ç«‹å‡å°‘ï¼Œå¹¶å¯èƒ½é™ä½ä¸€ä¸ªæˆ–å¤šä¸ªå­¦ä¹ ç‡ç»§ç»­

å­¦ä¹ ã€‚


`192`çš„`net_mode`çš„é»˜è®¤å€¼å¯ç”¨Adamå’Œç‰¹å®šäºå±‚çš„

å­¦ä¹ ç‡ã€‚


##å®Œç¾çš„æ ·æœ¬å»¶è¿Ÿ


å¯¹â€œç®€å•â€æ ·å“è¿›è¡ŒåŸ¹è®­ä¸ä¸€å®šæ˜¯ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºå®ƒæ˜¯æµªè´¹

æ—¶é—´ï¼Œä½†ç½‘ç»œä¸åº”è¯¥è¢«å…è®¸å¿˜è®°å¦‚ä½•å¤„ç†å®ƒä»¬ï¼Œæ‰€ä»¥å®ƒ

å¦‚æœå®ƒä»¬è¿‡äºé¢‘ç¹åœ°å‡ºç°ï¼Œå¯ä»¥ä¸¢å¼ƒä¸€äº›ç®€å•çš„æ ·å“ã€‚
è¯¥

`--perfect_sample_delay`å‚æ•°ä¸¢å¼ƒå®Œç¾æ ·æœ¬(å¦‚æœæ²¡æœ‰)

è‡ªä¸Šæ¬¡å®Œç¾æ ·æœ¬ä»¥æ¥çœ‹åˆ°çš„è®¸å¤šä¸å®Œç¾çš„ã€‚
ç›®å‰çš„é»˜è®¤å€¼

é›¶å€¼ä½¿ç”¨æ‰€æœ‰æ ·æœ¬ã€‚
åœ¨å®è·µä¸­ï¼Œä»·å€¼ä¼¼ä¹æ²¡æœ‰

å·¨å¤§çš„å½±å“ï¼Œå¦‚æœå…è®¸è®­ç»ƒè¿è¡Œè¶³å¤Ÿé•¿çš„æ—¶é—´ï¼Œé›¶å°±ä¼šäº§ç”Ÿ

æœ€å¥½çš„ç»“æœã€‚


## Debug Intervalå’ŒVisual Debugging


ä½¿ç”¨é›¶(é»˜è®¤)` -  debug_interval`ï¼ŒåŸ¹è®­å¸ˆè¾“å‡ºè¿›åº¦æŠ¥å‘Š

æ¯100æ¬¡è¿­ä»£ï¼Œç±»ä¼¼äºä»¥ä¸‹ç¤ºä¾‹ã€‚


```
At iteration 61239/65000/65015, Mean rms=1.62%, delta=8.587%, char train=16.786%, word train=36.633%, skip ratio=0.1%,  wrote checkpoint.

åœ¨è¿­ä»£61332/65100/65115ï¼Œå¹³å‡rms = 1.601ï¼…ï¼Œdelta = 8.347ï¼…ï¼Œchar train = 16.497ï¼…ï¼Œå•è¯ä¸²= 36.24ï¼…ï¼Œè·³è·ƒæ¯”= 0.1ï¼…ï¼Œå†™æ£€æŸ¥ç‚¹ã€‚


2ï¼…æ”¹è¿›æ—¶é—´= 44606ï¼Œæœ€ä½³è¯¯å·®ä¸º17.77 @ 16817

è­¦å‘Šï¼šLSTMTrainerååºåˆ—åŒ–LSTMRecognizerï¼

åœ¨è¿­ä»£61423/65200/65215ï¼Œå¹³å‡rms = 1.559ï¼…ï¼Œdelta = 7.841ï¼…ï¼Œchar train = 15.7ï¼…ï¼Œå•è¯ä¸²= 35.68ï¼…ï¼Œè·³è·ƒæ¯”= 0.1ï¼…ï¼Œæ–°çš„æœ€ä½³charé”™è¯¯= 15.7Atè¿­ä»£45481ï¼Œé˜¶æ®µ0ï¼Œ 
Eval Charé”™è¯¯ç‡= 6.9447893ï¼ŒWordé”™è¯¯ç‡= 27.039255å†™çš„æœ€ä½³å‹å·ï¼š./ SANLAYER / LAYER15.7_61423.checkpointå†™äº†æ£€æŸ¥ç‚¹ã€‚


```

ä½¿ç”¨`--debug_interval -1`ï¼ŒåŸ¹è®­å¸ˆä¸ºæ¯ä¸ªè¾“å‡ºè¯¦ç»†çš„è°ƒè¯•æ–‡æœ¬

è®­ç»ƒè¿­ä»£ã€‚
æ–‡æœ¬è°ƒè¯•ä¿¡æ¯åŒ…æ‹¬çœŸå®æ–‡æœ¬ï¼Œè¯†åˆ«æ–‡æœ¬ï¼Œ

è¿­ä»£æ¬¡æ•°ï¼Œè®­ç»ƒæ ·æœ¬id(lstmfæ–‡ä»¶å’Œè¡Œ)å’Œå¹³å‡å€¼

å‡ ä¸ªé”™è¯¯æŒ‡æ ‡ã€‚
åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½ä¼šæ˜¾ç¤ºè¯¥è¡Œçš„â€œGROUND TRUTHâ€ã€‚

`ALIGNED TRUTH`å’Œ`BEST OCR TEXT`ä»…åœ¨ä¸...ä¸åŒæ—¶æ˜¾ç¤º

â€œåœ°é¢çœŸç›¸â€ã€‚


```
Iteration 455038: GROUND  TRUTH : à¤‰à¤ªà¥‘ à¤¤à¥à¤µà¤¾à¤—à¥à¤¨à¥‡ à¤¦à¤¿à¥’à¤µà¥‡à¤¦à¤¿à¥‘à¤µà¥‡à¥’ à¤¦à¥‹à¤·à¤¾à¥‘à¤µà¤¸à¥à¤¤à¤°à¥à¤§à¤¿à¥’à¤¯à¤¾ à¤µà¥’à¤¯à¤®à¥ à¥¤
File /tmp/san-2019-03-28.jsY/san.Mangal.exp0.lstmf line 451 (Perfect):
Mean rms=1.267%, delta=4.155%, train=11.308%(32.421%), skip ratio=0%
Iteration 455039: GROUND  TRUTH : à¤®à¥‡ à¤…à¤ªà¤°à¤¾à¤§ à¤”à¤° à¤¬à¥ˆà¤ à¥‡ à¤¦à¥à¤•à¤¾à¤¨à¥‹à¤‚ à¤¨à¤¾à¤® à¤¸à¤•à¤¤à¥‡ à¤…à¤§à¤¿à¤µà¤•à¥à¤¤à¤¾, à¤¦à¥‹à¤¬à¤¾à¤°à¤¾ à¤¸à¤¾à¤§à¤¨ à¤µà¤¿à¤·à¥ˆà¤²à¥‡ à¤²à¤—à¤¾à¤¨à¥‡ à¤ªà¤° à¤ªà¥à¤°à¤¯à¥‹à¤—à¤•à¤°à¥à¤¤à¤¾à¤“à¤‚ à¤­à¤¾à¤—à¥‡
File /tmp/san-2019-04-04.H4m/san.FreeSerif.exp0.lstmf line 28 (Perfect):
Mean rms=1.267%, delta=4.153%, train=11.3%(32.396%), skip ratio=0%
```

```
Iteration 1526: GROUND  TRUTH : ğ’ƒ» ğ’€¸ ğ’†³ğ’†³ ğ’…˜ğ’Šğ’€€ğ’‹¾
Iteration 1526: ALIGNED TRUTH : ğ’ƒ» ğ’€¸ ğ’†³ğ’†³ ğ’…˜ğ’Šğ’Šğ’€€ğ’‹¾
Iteration 1526: BEST OCR TEXT :    ğ’€€ğ’‹¾
File /tmp/eng-2019-04-06.Ieb/eng.CuneiformComposite.exp0.lstmf line 19587 :
Mean rms=0.941%, delta=12.319%, train=56.134%(99.965%), skip ratio=0.6%
Iteration 1527: GROUND  TRUTH : ğ’€­ğ’Œ‹ğ’Š
Iteration 1527: BEST OCR TEXT : ğ’€­ğ’Œ‹
File /tmp/eng-2019-04-06.Ieb/eng.CuneiformOB.exp0.lstmf line 7771 :
Mean rms=0.941%, delta=12.329%, train=56.116%(99.965%), skip ratio=0.6%
```

ä½¿ç”¨`--debug_interval> 0`ï¼ŒåŸ¹è®­å¸ˆä¼šæ˜¾ç¤ºå‡ ä¸ªè°ƒè¯•çª—å£

æœ‰å…³ç½‘ç»œå±‚çš„ä¿¡æ¯ã€‚
åœ¨ç‰¹æ®Šæƒ…å†µä¸‹

`--debug_interval 1`å®ƒç­‰å¾…åœ¨'LSTMForward`çª—å£ä¸­ç‚¹å‡»ä¹‹å‰

ç»§ç»­ä¸‹ä¸€æ¬¡è¿­ä»£ï¼Œä½†å¯¹äºæ‰€æœ‰å…¶ä»–è¿­ä»£ï¼Œå®ƒåªæ˜¯ç»§ç»­å¹¶ç»˜åˆ¶

è¯·æ±‚é¢‘ç‡çš„ä¿¡æ¯ã€‚


**è¯·æ³¨æ„ï¼Œè¦ä½¿ç”¨--debug_interval> 0ï¼Œæ‚¨å¿…é¡»æ„å»º

[ScrollView.jar](ViewerDebugging)ä»¥åŠå…¶ä»–åŸ¹è®­å·¥å…·ã€‚**è§

[æ„å»ºåŸ¹è®­å·¥å…·](#building-the-training-tools)


å¯è§†åŒ–è°ƒè¯•ä¿¡æ¯åŒ…æ‹¬ï¼š


æ¯ä¸ªç½‘ç»œå±‚çš„å‰å‘å’Œåå‘çª—å£ã€‚
å¤§å¤šæ•°åªæ˜¯éšæœºçš„

å™ªéŸ³ï¼Œä½†`è¾“å‡º/è¾“å‡ºè¿”å›`å’Œ`ConvNL`çª—å£å€¼å¾—ä¸€çœ‹ã€‚

`Output`æ˜¾ç¤ºæœ€ç»ˆSoftmaxçš„è¾“å‡ºï¼Œè¯¥è¾“å‡ºä»¥é»„è‰²å¼€å§‹

nullå­—ç¬¦çš„è¡Œï¼Œå¹¶åœ¨æ¯ä¸ªç‚¹é€æ¸å½¢æˆé»„è‰²æ ‡è®°

å®ƒè®¤ä¸ºæœ‰ä¸€ä¸ªè§’è‰²ã€‚ 
(xè½´æ˜¯å›¾åƒxåæ ‡ï¼Œå’Œ

yè½´æ˜¯å­—ç¬¦ç±»ã€‚)`Output-back`çª—å£æ˜¾ç¤ºå·®å¼‚

å®é™…è¾“å‡ºå’Œç›®æ ‡ä¹‹é—´ä½¿ç”¨ç›¸åŒçš„å¸ƒå±€ï¼Œä½†æ˜¯å¸¦é»„è‰²

å› ä¸ºâ€œç»™æˆ‘æ›´å¤šè¿™ä¸ªâ€è€Œè“è‰²åˆ™æ˜¯â€œå°‘ç»™æˆ‘è¿™ä¸ªâ€ã€‚
ä½œä¸ºç½‘ç»œ

å­¦ä¹ ï¼Œ`ConvNL`çª—å£å¼€å‘å‡ºå…¸å‹çš„è¾¹ç¼˜æ£€æµ‹å™¨ç»“æœ

æœŸå¾…ä»åº•å±‚ã€‚


`LSTMForward`æ˜¾ç¤ºè®­ç»ƒå›¾åƒä¸Šæ•´ä¸ªç½‘ç»œçš„è¾“å‡ºã€‚

`LSTMTraining`æ˜¾ç¤ºè®­ç»ƒå›¾åƒä¸Šçš„è®­ç»ƒç›®æ ‡ã€‚
åœ¨ä¸¤è€…ä¸­ï¼Œç»¿è‰²

ç»˜åˆ¶çº¿æ¡ä»¥æ˜¾ç¤ºæ¯ä¸ªè§’è‰²å’Œè§’è‰²çš„å³°å€¼è¾“å‡º

æœ¬èº«è¢«åˆ’çº¿å³ä¾§ã€‚


å€¼å¾—å…³æ³¨çš„å¦å¤–ä¸¤ä¸ªçª—å£æ˜¯â€œCTCè¾“å‡ºâ€å’Œâ€œCTCç›®æ ‡â€ã€‚

è¿™äº›æ˜¾ç¤ºç½‘ç»œçš„å½“å‰è¾“å‡ºå’Œç›®æ ‡ä½œä¸ºçº¿å›¾

è¾“å‡ºå¼ºåº¦å¯¹å›¾åƒxåæ ‡ã€‚
è€Œä¸æ˜¯çƒ­åƒï¼Œåƒ

`Output`çª—å£ï¼Œä¸ºæ¯ä¸ªå­—ç¬¦ç±»ç»˜åˆ¶ä¸€æ¡ä¸åŒé¢œè‰²çš„çº¿æ¡

yè½´æ˜¯è¾“å‡ºå¼ºåº¦ã€‚


#TessTutorial


[åˆ›å»ºè®­ç»ƒæ•°æ®](ï¼ƒcreating-training-data)çš„è¿‡ç¨‹æ˜¯

è®°å½•å¦‚ä¸‹ï¼Œç„¶åæ˜¯[æ•™ç¨‹æŒ‡å—

lstmtraining](ï¼ƒtutorial-guide-to-lstmtraining)ï¼Œä»‹ç»äº†

ä¸»è¦çš„åŸ¹è®­è¿‡ç¨‹ï¼Œä½¿ç”¨å·²ç»è¿‡å®é™…æµ‹è¯•çš„å‘½ä»¤è¡Œã€‚
ä¸Š

è‡³å°‘Linuxï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿå°†å‘½ä»¤è¡Œå¤åˆ¶ç²˜è´´åˆ°

ä½ çš„ç»ˆç«¯ã€‚


ä¸ºäº†ä½¿`tesstrain.sh`è„šæœ¬æœ‰æ•ˆï¼Œæœ‰å¿…è¦

è¦ä¹ˆè®¾ç½®`PATH`æ¥åŒ…å«ä½ çš„æœ¬åœ°`training`å’Œ`api`ç›®å½•ï¼Œè¦ä¹ˆä½¿ç”¨

`make install`ã€‚


## TessTutorialçš„ä¸€æ¬¡æ€§å®‰è£…


ä¸ºäº†æˆåŠŸè¿è¡ŒTessTutorialï¼Œæ‚¨éœ€è¦æœ‰ä¸€ä¸ªå·¥ä½œ

å®‰è£…tesseractå’ŒåŸ¹è®­å·¥å…·ï¼Œå¹¶æœ‰åŸ¹è®­è„šæœ¬å’Œ

åœ¨æŸäº›ç›®å½•ä¸­éœ€è¦è®­ç»ƒæœ‰ç´ çš„æ•°æ®æ–‡ä»¶ã€‚

è¿™äº›è¯´æ˜ä»…æ¶µç›–ä»å­—ä½“æ¸²æŸ“çš„æƒ…å†µï¼Œ

æ‰€ä»¥å¿…é¡»å…ˆå®‰è£…[æ‰€éœ€å­—ä½“](å­—ä½“)ã€‚

è¯·æ³¨æ„ï¼Œæ‚¨çš„å­—ä½“ä½ç½®å¯èƒ½æœ‰æ‰€ä¸åŒ


```
sudo apt update
sudo apt install ttf-mscorefonts-installer
sudo apt install fonts-dejavu
fc-cache -vf
```

è¯·æŒ‰ç…§ä»¥ä¸‹è¯´æ˜æ“ä½œ

ä¸ºTessTutorialåšç¬¬ä¸€æ¬¡è®¾ç½®ã€‚


```
mkdir ~/tesstutorial
cd ~/tesstutorial

mkdir langdata

cd langdata

wget https://raw.githubusercontent.com/tesseract-ocr/langdata_lstm/master/radical-stroke.txt

wget https://raw.githubusercontent.com/tesseract-ocr/langdata_lstm/master/common.punc

wget https://raw.githubusercontent.com/tesseract-ocr/langdata_lstm/master/font_properties

wget https://raw.githubusercontent.com/tesseract-ocr/langdata_lstm/master/Latin.unicharset

wget https://raw.githubusercontent.com/tesseract-ocr/langdata_lstm/master/Latin.xheights

mkdir eng

cd eng

wget https://raw.githubusercontent.com/tesseract-ocr/langdata/master/eng/eng.training_text

wget https://raw.githubusercontent.com/tesseract-ocr/langdata/master/eng/eng.punc

wget https://raw.githubusercontent.com/tesseract-ocr/langdata/master/eng/eng.numbers

wget https://raw.githubusercontent.com/tesseract-ocr/langdata/master/eng/eng.wordlist


cd~ / tesstutorial

git clone --depth 1 https://github.com/tesseract-ocr/tesseract.git

cd tesseract / tessdata

mkdiræœ€å¥½

cdæœ€å¥½

wget https://github.com/tesseract-ocr/tessdata_best/raw/master/eng.traineddata

wget https://github.com/tesseract-ocr/tessdata_best/raw/master/heb.traineddata

wget https://github.com/tesseract-ocr/tessdata_best/raw/master/chi_sim.traineddata


```

##åˆ›å»ºåŸ¹è®­æ•°æ®


ä¸åŸºç¡€Tesseractä¸€æ ·ï¼Œå¯ä»¥åœ¨æ¸²æŸ“åˆæˆè®­ç»ƒä¹‹é—´è¿›è¡Œé€‰æ‹©

æ¥è‡ªå­—ä½“çš„æ•°æ®ï¼Œæˆ–æ ‡è®°ä¸€äº›é¢„å…ˆå­˜åœ¨çš„å›¾åƒ(å¦‚å¤ä»£æ‰‹ç¨¿)

ä¾‹å¦‚)ã€‚
Â Â 

åœ¨ä»»ä½•ä¸€ç§æƒ…å†µä¸‹ï¼Œæ‰€éœ€çš„æ ¼å¼ä»ç„¶æ˜¯tiff / boxæ–‡ä»¶

å¯¹ï¼Œé™¤äº†ç›’å­åªéœ€è¦è¦†ç›–æ–‡æœ¬è¡Œè€Œä¸æ˜¯ä¸ªäºº

å­—ç¬¦ã€‚


###åˆ¶ä½œç›’å­æ–‡ä»¶


Tesseract 4æ¥å—å¤šç§æ ¼å¼çš„ç›’å­æ–‡ä»¶è¿›è¡ŒLSTMåŸ¹è®­ï¼Œ

è™½ç„¶å®ƒä»¬ä¸Tesseract 3ä½¿ç”¨çš„ä¸åŒ

([ç»†èŠ‚](https://github.com/tesseract-ocr/tesseract/issues/2357))ã€‚


æ¡†æ–‡ä»¶ä¸­çš„æ¯ä¸€è¡Œéƒ½åŒ¹é…tiffå›¾åƒä¸­çš„â€œå­—ç¬¦â€(å­—å½¢)ã€‚


`<symbol> <left> <bottom> <right> <top> <page>`

å…¶ä¸­`<left> <bottom> <right> <top> <page>`å¯ä»¥æ˜¯è¾¹ç•Œæ¡†åæ ‡

å•ä¸ªå­—å½¢æˆ–æ•´ä¸ªæ–‡æœ¬è¡Œ([å‚è§ç¤ºä¾‹](https://github.com/tesseract-ocr/tesseract/issues/2357#issuecomment-477239316))ã€‚


è¦æ ‡è®°æ–‡æœ¬è¡Œå°¾ï¼Œå¿…é¡»åœ¨ä¸€ç³»åˆ—è¡Œåæ’å…¥ä¸€ä¸ªç‰¹æ®Šè¡Œã€‚


`<tab> <left> <bottom> <right> <top> <page>`


è¯·æ³¨æ„ï¼Œåœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œå³ä½¿æ˜¯ä»å³åˆ°å·¦çš„è¯­è¨€ï¼Œä¾‹å¦‚é˜¿æ‹‰ä¼¯è¯­ï¼Œ

è¡Œçš„æ–‡æœ¬è½¬å½•ï¼Œ*åº”ä»å·¦åˆ°å³æ’åºã€‚*æ¢å¥è¯è¯´ï¼Œç½‘ç»œ

æ— è®ºè¯­è¨€å¦‚ä½•ï¼Œéƒ½å°†ä»å·¦åˆ°å³å­¦ä¹ 

ä»å³åˆ°å·¦/æ¯”è¿ªçš„å¤„ç†å‘ç”Ÿåœ¨Tesseractå†…éƒ¨çš„æ›´é«˜å±‚æ¬¡ã€‚




###ä½¿ç”¨tesstrain.sh


è¿è¡Œtesstrain.shçš„è®¾ç½®æ˜¯

ä¸åŸºç¡€Tesseractç›¸åŒã€‚
ä½¿ç”¨`--linedata_only`é€‰é¡¹è¿›è¡ŒLSTMåŸ¹è®­ã€‚

è¯·æ³¨æ„ï¼Œæ¥å—æ›´å¤šåŸ¹è®­æ˜¯æœ‰ç›Šçš„

æ–‡æœ¬å’Œåˆ¶ä½œæ›´å¤šé¡µé¢ï¼Œå› ä¸ºç¥ç»ç½‘ç»œä¹Ÿæ²¡æœ‰æ¦‚æ‹¬å’Œ

éœ€è¦è®­ç»ƒç±»ä¼¼äºä»–ä»¬å°†è¦è¿è¡Œçš„ä¸œè¥¿ã€‚
å¦‚æœ

ç›®æ ‡åŸŸä¸¥é‡å—é™ï¼Œç„¶åæ‰€æœ‰å…³äºéœ€è¦çš„å¯æ€•è­¦å‘Š

è®¸å¤šåŸ¹è®­æ•°æ®å¯èƒ½ä¸é€‚ç”¨ï¼Œä½†å¯èƒ½éœ€è¦ç½‘ç»œè§„èŒƒ

æ”¹å˜ã€‚


ä½¿ç”¨[tesstrain.sh](https://github.com/tesseract-ocr/tesseract/blob/master/src/training/tesstrain.sh)åˆ›å»ºè®­ç»ƒæ•°æ®

å¦‚ä¸‹ï¼š


```
src/training/tesstrain.sh --fonts_dir /usr/share/fonts --lang eng --linedata_only \
  --noextract_font_properties --langdata_dir ../langdata \
  --tessdata_dir ./tessdata --output_dir ~/tesstutorial/engtrain
```

ä¸Šè¿°å‘½ä»¤ä½¿LSTMè®­ç»ƒæ•°æ®ç­‰åŒäºç”¨äºè®­ç»ƒçš„æ•°æ®

åŸºç¡€Tesseractè‹±è¯­ã€‚
ä¸ºäº†åˆ¶ä½œé€šç”¨çš„åŸºäºLSTMçš„OCRå¼•æ“ï¼Œ

è¿™æ˜¯éå¸¸ä¸è¶³å¤Ÿçš„ï¼Œä½†æ˜¯åšäº†ä¸€ä¸ªå¾ˆå¥½çš„æ•™ç¨‹æ¼”ç¤ºã€‚


ç°åœ¨å°è¯•è¿™ä¸ªæ¥åˆ¶ä½œ'Impact'å­—ä½“çš„evalæ•°æ®ï¼š


```
src/training/tesstrain.sh --fonts_dir /usr/share/fonts --lang eng --linedata_only \
  --noextract_font_properties --langdata_dir ../langdata \
  --tessdata_dir ./tessdata \
  --fontlist "Impact Condensed" --output_dir ~/tesstutorial/engeval
```
We will use that data later to demonstrate tuning.

## lstmtrainingæ•™ç¨‹æŒ‡å—


###åˆ›å»ºStarter Traineddata


æ³¨æ„ï¼šè¿™æ˜¯ä¸€ä¸ªæ–°çš„æ­¥éª¤ï¼


è€Œä¸æ˜¯`unicharset`å’Œ`script_dirï¼Œ``lstmtraining`ç°åœ¨éœ€è¦ä¸€ä¸ª

`trainingdata`æ–‡ä»¶åœ¨å…¶å‘½ä»¤è¡Œä¸Šï¼Œä»¥è·å–å®ƒéœ€è¦çš„æ‰€æœ‰ä¿¡æ¯

å…³äºè¦å­¦ä¹ çš„è¯­è¨€ã€‚ 
`traineddata` *å¿…é¡»*è‡³å°‘åŒ…å«ä¸€ä¸ª

`lstm-unicharset`å’Œ`lstm-recoder`ç»„ä»¶ï¼Œä¹Ÿå¯èƒ½åŒ…å«ä¸‰ä¸ª

dawgæ–‡ä»¶ï¼š`lstm-punc-dawg lstm-word-dawg lstm-number-dawg``config`æ–‡ä»¶æ˜¯

ä¹Ÿæ˜¯å¯é€‰çš„ã€‚
å…¶ä»–ç»„ä»¶(å¦‚æœå­˜åœ¨)å°†è¢«å¿½ç•¥å’Œæœªä½¿ç”¨ã€‚


æ²¡æœ‰å·¥å…·å¯ä»¥ç›´æ¥åˆ›å»º`lstm-recoder`ã€‚
ç›¸åï¼Œæœ‰ä¸€ä¸ªæ–°çš„

å·¥å…·ï¼Œ`combine_lang_model`ï¼Œå®ƒè¾“å…¥`input_unicharset`å’Œ

`script_dir`(`script_dir`æŒ‡å‘`langdata`ç›®å½•)å’Œ`lang`(`lang`æ˜¯

æ­£åœ¨ä½¿ç”¨çš„è¯­è¨€)å’Œå¯é€‰çš„å•è¯åˆ—è¡¨æ–‡ä»¶ã€‚
å®ƒåˆ›é€ äº†`lstm-recoder`

æ¥è‡ª`input_unicharset`å¹¶åˆ›å»ºæ‰€æœ‰dawgsï¼Œå¦‚æœæä¾›äº†å•è¯åˆ—è¡¨ï¼Œ

æŠŠæ‰€æœ‰ä¸œè¥¿æ”¾åœ¨ä¸€ä¸ª`è®­ç»ƒçš„æ•°æ®'æ–‡ä»¶ä¸­ã€‚




###ä»å¤´å¼€å§‹è®­ç»ƒ


ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºäº†ä»å¤´å¼€å§‹è¿›è¡ŒåŸ¹è®­çš„å‘½ä»¤è¡Œã€‚
è¯•è¯•å§

ä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤è¡Œåˆ›å»ºçš„é»˜è®¤è®­ç»ƒæ•°æ®ã€‚


```
mkdir -p ~/tesstutorial/engoutput
training/lstmtraining --debug_interval 100 \
  --traineddata ~/tesstutorial/engtrain/eng/eng.traineddata \
  --net_spec '[1,36,0,1 Ct3,3,16 Mp3,3 Lfys48 Lfx96 Lrx96 Lfx256 O1c111]' \
  --model_output ~/tesstutorial/engoutput/base --learning_rate 20e-4 \
  --train_listfile ~/tesstutorial/engtrain/eng.training_files.txt \
  --eval_listfile ~/tesstutorial/engeval/eng.training_files.txt \
  --max_iterations 5000 &>~/tesstutorial/engoutput/basetrain.log
```

åœ¨å•ç‹¬çš„çª—å£ä¸­ç›‘è§†æ—¥å¿—æ–‡ä»¶ï¼š


```
tail -f ~/tesstutorial/engoutput/basetrain.log
```

(å¦‚æœæ‚¨ä¹‹å‰å°è¯•è¿‡æœ¬æ•™ç¨‹ï¼Œæ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°è¿™äº›æ•°å­—æœ‰

æ”¹å˜ã€‚
è¿™æ˜¯ä¸€ä¸ªç•¥å°çš„ç½‘ç»œçš„ç»“æœï¼Œå¹¶æ·»åŠ äº†

ADAMä¼˜åŒ–å™¨ï¼Œå¯å®ç°æ›´é«˜çš„å­¦ä¹ é€Ÿåº¦ã€‚)


æ‚¨åº”è¯¥è§‚å¯Ÿåˆ°600æ¬¡è¿­ä»£ï¼Œç©ºæ ¼(ç™½è‰²)å¼€å§‹

æ˜¾ç¤ºåœ¨â€œCTCè¾“å‡ºâ€çª—å£ä¸Šï¼Œå¹¶é€šè¿‡1300æ¬¡è¿­ä»£æ˜¾ç¤ºç»¿çº¿

`LSTMForward`çª—å£ï¼Œå›¾åƒä¸­æœ‰ç©ºæ ¼ã€‚


ç»è¿‡1300æ¬¡è¿­ä»£ï¼Œâ€œCTCè¾“å‡ºâ€ä¸­å‡ºç°æ˜æ˜¾çš„éç©ºé—´é¢ ç°¸

è¯·æ³¨æ„ï¼Œä»æ‰€æœ‰ç›¸åŒé«˜åº¦å¼€å§‹çš„`CTC Targets'ç°åœ¨éƒ½æ˜¯å˜åŒ–çš„

ç”±äºç©ºé—´çš„ç¡®å®šè¾“å‡ºå’Œä¸€äº›å’Œæš‚å®šçš„é«˜åº¦

å…¶ä»–å­—ç¬¦çš„è¾“å‡ºã€‚
åŒæ—¶ï¼Œäººç‰©å’Œå®šä½

`LSTMTraining`çª—å£ä¸­çš„ç»¿çº¿ä¸å¦‚å®ƒä»¬å‡†ç¡®

æœ€åˆï¼Œå› ä¸ºç½‘ç»œçš„éƒ¨åˆ†è¾“å‡ºæ··æ·†äº†CTC

ç®—æ³•ã€‚ 
(CTCå‡è®¾ä¸åŒçš„ç»Ÿè®¡ç‹¬ç«‹æ€§

xåæ ‡ï¼Œä½†å®ƒä»¬æ˜¾ç„¶ä¸æ˜¯ç‹¬ç«‹çš„ã€‚)


é€šè¿‡2000æ¬¡è¿­ä»£ï¼Œåœ¨â€œè¾“å‡ºâ€çª—å£ä¸­åº”è¯¥æ¸…æ¥šæœ‰äº›å¾®å¼±

é»„è‰²æ ‡è®°ä¼¼ä¹è¡¨æ˜æœ‰ä¸€äº›å¢é•¿çš„äº§é‡

éç©ºå’Œéç©ºæ ¼ï¼Œå­—ç¬¦å¼€å§‹å‡ºç°åœ¨

`LSTMForward`çª—å£ã€‚


åœ¨3700æ¬¡è¿­ä»£ä¹‹åï¼Œå­—ç¬¦é”™è¯¯ç‡é™è‡³50ï¼…ä»¥ä¸‹ï¼Œå¹¶ä¸”é™ä½åˆ°5000

å¤§çº¦13ï¼…ï¼Œå®ƒå°†ç»ˆæ­¢ã€‚ 
(çº¦20åˆ†é’Ÿçš„ç”µæµ

å¸¦AVXçš„é«˜ç«¯æœºå™¨ã€‚)


è¯·æ³¨æ„ï¼Œæ­¤å¼•æ“ä½¿ç”¨ä¸ä½¿ç”¨çš„ç›¸åŒæ•°é‡çš„è®­ç»ƒæ•°æ®è¿›è¡Œè®­ç»ƒ

ä¼ ç»Ÿçš„Tesseractå¼•æ“ï¼Œä½†å…¶åœ¨å…¶ä»–å­—ä½“ä¸Šçš„å‡†ç¡®æ€§å¯èƒ½éå¸¸é«˜

è¾ƒå·®çš„ã€‚
å¯¹'Impact'å­—ä½“è¿è¡Œç‹¬ç«‹æµ‹è¯•ï¼š


```
training/lstmeval --model ~/tesstutorial/engoutput/base_checkpoint \
  --traineddata ~/tesstutorial/engtrain/eng/eng.traineddata \
  --eval_listfile ~/tesstutorial/engeval/eng.training_files.txt
```

85ï¼…çš„å­—ç¬¦é”™è¯¯ç‡ï¼Ÿ
ä¸å¤ªå¥½ï¼


ç°åœ¨ï¼ŒåŸºç¡€Tesseractåœ¨â€œå½±å“â€æ–¹é¢è¡¨ç°ä¸ä½³ï¼Œä½†å®ƒåŒ…æ‹¬åœ¨å†…

4500å·¦å³çš„å­—ä½“ç”¨äºè®­ç»ƒæ–°çš„LSTMç‰ˆæœ¬ï¼Œæ‰€ä»¥å¦‚æœä½ å¯ä»¥è¿è¡Œé‚£ä¸ª

æ¯”è¾ƒï¼š


```
training/lstmeval --model tessdata/best/eng.traineddata \
  --eval_listfile ~/tesstutorial/engeval/eng.training_files.txt
```

2.45ï¼…çš„å­—ç¬¦é”™è¯¯ç‡ï¼Ÿ
å¥½å¤šäº†ï¼


åœ¨ä¸‹ä¸€èŠ‚ä¸­ä¾›å‚è€ƒï¼Œä¹Ÿå¯ä»¥åœ¨ä¸Šé¢è¿è¡Œå®Œæ•´æ¨¡å‹çš„æµ‹è¯•

æˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨çš„è®­ç»ƒé›†ï¼š


```
training/lstmeval --model tessdata/best/eng.traineddata \
  --eval_listfile ~/tesstutorial/engtrain/eng.training_files.txt
```

å­—ç¬¦é”™è¯¯ç‡= 0.25047642ï¼Œå­—é”™è¯¯ç‡= 0.63389585


(å¦‚æœä½ ä¹‹å‰è¿è¡Œè¿‡ï¼Œå¹¶æ³¨æ„é”™è¯¯ç‡è¿œé«˜äº

ä¹‹å‰çš„alphaç‰ˆæœ¬ï¼Œè¿™æ˜¯ç”±äºå½¢çŠ¶æŠ¥ä»·çš„ä½¿ç”¨å‘ç”Ÿäº†å˜åŒ–ã€‚

å®ƒä¹‹å‰æ²¡æœ‰è®¡ç®—å¼•å·å½¢çŠ¶ä¸­çš„é”™è¯¯ï¼Œä½†ç°åœ¨ç¡®å®å¦‚æ­¤ã€‚)


ä½ å¯ä»¥è®­ç»ƒå¦å¤–5000æ¬¡è¿­ä»£ï¼Œå¹¶è·å¾—é”™è¯¯ç‡

è®­ç»ƒè®¾ç½®ä½å¾ˆå¤šï¼Œä½†å®ƒå¯¹â€œImpactâ€å­—ä½“æ²¡æœ‰å¤šå¤§å¸®åŠ©ï¼š


```
mkdir -p ~/tesstutorial/engoutput
training/lstmtraining \
  --traineddata ~/tesstutorial/engtrain/eng/eng.traineddata \
  --net_spec '[1,36,0,1 Ct3,3,16 Mp3,3 Lfys48 Lfx96 Lrx96 Lfx256 O1c111]' \
  --model_output ~/tesstutorial/engoutput/base --learning_rate 20e-4 \
  --train_listfile ~/tesstutorial/engtrain/eng.training_files.txt \
  --eval_listfile ~/tesstutorial/engeval/eng.training_files.txt \
  --max_iterations 10000 &>>~/tesstutorial/engoutput/basetrain.log
```

â€œå½±å“â€ç°åœ¨çš„å­—ç¬¦é”™è¯¯ç‡> 100ï¼…ï¼Œå³ä½¿é”™è¯¯ç‡ä¹Ÿæ˜¯å¦‚æ­¤

è®­ç»ƒé›†å·²ä¸‹é™åˆ°2.68ï¼…å­—ç¬¦/ 10.01ï¼…å­—ï¼š


```
training/lstmeval --model ~/tesstutorial/engoutput/base_checkpoint \
  --traineddata ~/tesstutorial/engtrain/eng/eng.traineddata \
  --eval_listfile ~/tesstutorial/engeval/eng.training_files.txt
```

è¿™è¡¨æ˜è¯¥æ¨¡å‹å®Œå…¨è¿‡åº¦é€‚åº”æ‰€æä¾›çš„è®­ç»ƒ

ç»„ï¼
å®ƒå¾ˆå¥½åœ°è¯´æ˜äº†è®­ç»ƒé›†æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ

ä¸åŒ…æ‹¬ç›®æ ‡æ•°æ®ä¸­çš„æ‰€éœ€å˜åŒ–ã€‚


æ€»ä¹‹ï¼Œä»å¤´å¼€å§‹çš„åŸ¹è®­éœ€è¦ä¸€ä¸ªéå¸¸æœ‰é™çš„é—®é¢˜ï¼Œå¾ˆå¤š

è®­ç»ƒæ•°æ®ï¼Œæˆ–è€…ä½ éœ€è¦é€šè¿‡å‡å°‘ä¸€äº›æ¥ç¼©å°ç½‘ç»œ

ä¸Šé¢`--net_spec`ä¸­å›¾å±‚çš„å¤§å°ã€‚
æˆ–è€…ï¼Œä½ å¯ä»¥å°è¯•

è°ƒæ•´...


###å¾®è°ƒå½±å“åŠ›


å¾®è°ƒæ˜¯åœ¨æ²¡æœ‰æ–°æ•°æ®çš„æƒ…å†µä¸‹è®­ç»ƒç°æœ‰æ¨¡å‹çš„è¿‡ç¨‹

æ”¹å˜ç½‘ç»œçš„ä»»ä½•éƒ¨åˆ†ï¼Œè™½ç„¶ä½ **ç°åœ¨å¯ä»¥**æ·»åŠ 

å­—ç¬¦é›†ä¸­çš„å­—ç¬¦ã€‚ 
(å‚è§[å¾®è°ƒå‡ ä¸‹]
Â Â Â Â Â Â Â Â 
å­—ç¬¦](ï¼ƒå¾®è°ƒæ¢ - Î±-å‡ ä¸ªå­—ç¬¦))ã€‚


```
training/lstmtraining --model_output /path/to/output [--max_image_MB 6000] \
  --continue_from /path/to/existing/model \
  --traineddata /path/to/original/traineddata \
  [--perfect_sample_delay 0] [--debug_interval 0] \
  [--max_iterations 0] [--target_error_rate 0.01] \
  --train_listfile /path/to/list/of/filenames.txt
```

**æ³¨æ„**`--continue_from`argå¯ä»¥æŒ‡å‘è®­ç»ƒæ£€æŸ¥ç‚¹

**æˆ–**è¯†åˆ«æ¨¡å‹ï¼Œ*å³ä½¿æ–‡ä»¶æ ¼å¼ä¸åŒã€‚*

è®­ç»ƒæ£€æŸ¥ç‚¹æ˜¯ä»¥`--model_output`å¼€å¤´çš„æ–‡ä»¶

åœ¨`checkpoint`ã€‚
å¯ä»¥ä»ç°æœ‰çš„æå–ä¸­è¯†åˆ«æ¨¡å‹

ä½¿ç”¨`combine_tessdataè®­ç»ƒçš„æ•°æ®æ–‡ä»¶ã€‚æ³¨æ„å®ƒä¹Ÿæ˜¯å¿…è¦çš„

æä¾›åŸå§‹çš„è®­ç»ƒæ•°æ®æ–‡ä»¶ï¼Œå› ä¸ºå®ƒåŒ…å«unicharset

å’Œé‡æ–°ç¼–ç ã€‚
è®©æˆ‘ä»¬é¦–å…ˆå¾®è°ƒæˆ‘ä»¬ä¹‹å‰æ„å»ºçš„æ¨¡å‹ï¼Œçœ‹çœ‹æ˜¯å¦

æˆ‘ä»¬å¯ä»¥ä½¿å®ƒé€‚ç”¨äº'å½±å“'ï¼š


```
mkdir -p ~/tesstutorial/impact_from_small
training/lstmtraining --model_output ~/tesstutorial/impact_from_small/impact \
  --continue_from ~/tesstutorial/engoutput/base_checkpoint \
  --traineddata ~/tesstutorial/engtrain/eng/eng.traineddata \
  --train_listfile ~/tesstutorial/engeval/eng.training_files.txt \
  --max_iterations 1200
```

åœ¨100æ¬¡è¿­ä»£åï¼Œå®ƒçš„å­—ç¬¦/å•è¯é”™è¯¯ä¸º22.36ï¼…/ 50.0ï¼…å¹¶ä¸”ä¸‹é™

åœ¨1200å¤„è¾¾åˆ°0.3ï¼…/ 1.2ï¼…ã€‚ç°åœ¨æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æµ‹è¯•ï¼š


```
training/lstmeval --model ~/tesstutorial/impact_from_small/impact_checkpoint \
  --traineddata ~/tesstutorial/engtrain/eng/eng.traineddata \
  --eval_listfile ~/tesstutorial/engeval/eng.training_files.txt
```

ç”±äºåŸ¹è®­å¸ˆçš„å¹³å‡å€¼ï¼Œè¿™æ˜¾ç¤ºäº†0.0086ï¼…/ 0.057ï¼…çš„æ›´å¥½ç»“æœ

è¶…è¿‡1000æ¬¡è¿­ä»£ï¼Œå¹¶ä¸”ä¸€ç›´åœ¨æ”¹è¿›ã€‚
è¿™ä¸æ˜¯ä»£è¡¨

å› ä¸ºæˆ‘ä»¬æ­£åœ¨æµ‹è¯•è®­ç»ƒæ•°æ®ï¼Œæ‰€ä»¥â€œImpactâ€å­—ä½“çš„ç»“æœï¼


è¿™æ˜¯ä¸€ä¸ªç©å…·çš„ä¾‹å­ã€‚
å¾®è°ƒçš„æƒ³æ³•å®é™…ä¸Šæ˜¯åº”ç”¨å®ƒ

åˆ°ä¸€ä¸ªè®­ç»ƒæœ‰ç´ çš„ç°æœ‰æ¨¡å‹ï¼š


```
mkdir -p ~/tesstutorial/impact_from_full
training/combine_tessdata -e tessdata/best/eng.traineddata \
  ~/tesstutorial/impact_from_full/eng.lstm
training/lstmtraining --model_output ~/tesstutorial/impact_from_full/impact \
  --continue_from ~/tesstutorial/impact_from_full/eng.lstm \
  --traineddata tessdata/best/eng.traineddata \
  --train_listfile ~/tesstutorial/engeval/eng.training_files.txt \
  --max_iterations 400
```

åœ¨100æ¬¡è¿­ä»£ä¹‹åï¼Œå®ƒå…·æœ‰1.35ï¼…/ 4.56ï¼…çš„å­—ç¬¦/å­—é”™è¯¯å¹¶ä¸”ä¸‹é™åˆ°

åœ¨400æ—¶ï¼Œ0.533ï¼…/ 1.633ï¼…ã€‚å†æ¬¡ï¼Œç‹¬ç«‹æµ‹è¯•ç»™å‡ºäº†æ›´å¥½çš„ç»“æœï¼š


```
training/lstmeval --model ~/tesstutorial/impact_from_full/impact_checkpoint \
  --traineddata tessdata/best/eng.traineddata \
  --eval_listfile ~/tesstutorial/engeval/eng.training_files.txt
```

å­—ç¬¦é”™è¯¯0.017ï¼…ï¼Œå•è¯0.120ï¼…ç„¶è€Œï¼Œæ›´æœ‰è¶£çš„æ˜¯æ•ˆæœ

å…¶ä»–å­—ä½“ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬ä¸€ç›´ä½¿ç”¨çš„åŸºç¡€è®­ç»ƒé›†ä¸Šè¿è¡Œæµ‹è¯•ï¼š


```
training/lstmeval --model ~/tesstutorial/impact_from_full/impact_checkpoint \
  --traineddata tessdata/best/eng.traineddata \
  --eval_listfile ~/tesstutorial/engtrain/eng.training_files.txt
```

å­—ç¬¦é”™è¯¯ç‡= 0.25548592ï¼Œå­—é”™è¯¯ç‡= 0.82523491


å®ƒåªæ˜¯ç¨å¾®å·®ä¸€ç‚¹ï¼Œå°½ç®¡å·²ç»è¾¾åˆ°æ¥è¿‘é›¶è¯¯å·®

è®­ç»ƒé›†ï¼Œä»…åœ¨400æ¬¡è¿­ä»£ä¸­å®ç°ã€‚ 
**è¿›ä¸€æ­¥æ³¨æ„

è¶…è¿‡400æ¬¡è¿­ä»£çš„è®­ç»ƒä¼šä½¿åŸºç¡€ä¸Šçš„é”™è¯¯æ›´é«˜ã€‚**


æ€»ä¹‹ï¼Œé¢„è®­ç»ƒæ¨¡å‹å¯ä»¥å¾®è°ƒæˆ–é€‚åº”å°æ•°æ®

è®¾ç½®ï¼Œ**å¯¹å…¶ä¸€èˆ¬å‡†ç¡®æ€§æ²¡æœ‰å¤ªå¤§çš„ä¼¤å®³ã€‚**å®ƒä»ç„¶éå¸¸

ç„¶è€Œï¼Œé‡è¦çš„æ˜¯é¿å…è¿‡åº¦æ‹Ÿåˆã€‚


###å¾®è°ƒå‡ ä¸ªå­—ç¬¦


**æ–°åŠŸèƒ½**å¯ä»¥åœ¨å­—ç¬¦é›†ä¸­æ·»åŠ ä¸€äº›æ–°å­—ç¬¦

å¹¶é€šè¿‡å¾®è°ƒè®­ç»ƒä»–ä»¬ï¼Œæ²¡æœ‰å¤§é‡çš„è®­ç»ƒæ•°æ®ã€‚


åŸ¹è®­éœ€è¦ä¸€ä¸ªæ–°çš„unicharset /é‡æ–°ç¼–ç å™¨ï¼Œå¯é€‰çš„è¯­è¨€æ¨¡å‹ï¼Œå’Œ

æ—§çš„è®­ç»ƒæ•°æ®æ–‡ä»¶åŒ…å«æ—§çš„unicharset /é‡æ–°ç¼–ç å™¨ã€‚


```
training/lstmtraining --model_output /path/to/output [--max_image_MB 6000] \
  --continue_from /path/to/existing/model \
  --traineddata /path/to/traineddata/with/new/unicharset \
  --old_traineddata /path/to/existing/traineddata \
  [--perfect_sample_delay 0] [--debug_interval 0] \
  [--max_iterations 0] [--target_error_rate 0.01] \
  --train_listfile /path/to/list/of/filenames.txt
```

è®©æˆ‘ä»¬å°è¯•å°†åŠ å· - å‡å·(Â±)æ·»åŠ åˆ°ç°æœ‰çš„è‹±è¯­æ¨¡å‹ä¸­ã€‚
ä¿®æ”¹

`langdata / eng / eng.training_text`åŒ…å«ä¸€äº›Â±çš„æ ·æœ¬ã€‚
æˆ‘æ’äº†14ä¸ª

ä»–ä»¬ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š


```
grep Â± ../langdata/eng/eng.training_text
alkoxy of LEAVES Â±1.84% by Buying curved RESISTANCE MARKED Your (Vol. SPANIEL
TRAVELED Â±85Â¢ , reliable Events THOUSANDS TRADITIONS. ANTI-US Bedroom Leadership
Inc. with DESIGNS self; ball changed. MANHATTAN Harvey's Â±1.31 POPSET Osâ€”C(11)
VOLVO abdomen, Â±65Â°C, AEROMEXICO SUMMONER = (1961) About WASHING Missouri
PATENTSCOPEÂ® # Â© HOME SECOND HAI Business most COLETTI, Â±14Â¢ Flujo Gilbert
Dresdner Yesterday's Dilated SYSTEMS Your FOUR Â±90Â° Gogol PARTIALLY BOARDS ï¬rm
Email ACTUAL QUEENSLAND Carl's Unruly Â±8.4 DESTRUCTION customers DataVacÂ® DAY
Kollman, for â€˜plankedâ€™ key max) View Â«LINKÂ» PRIVACY BY Â±2.96% Ask! WELL
Lambert own Company View mg \ (Â±7) SENSOR STUDYING Feb EVENTUALLY [It Yahoo! Tv
United by #DEFINE Rebel PERFORMED Â±500Gb Oliver Forums Many | Â©2003-2008 Used OF
Avoidance Moosejaw pm* Â±18 note: PROBE Jailbroken RAISE Fountains Write Goods (Â±6)
Oberï¬‚achen source.â€ CULTURED CUTTING Home 06-13-2008, Â§ Â±44.01189673355 â‚¬
netting Bookmark of WE MORE) STRENGTH IDENTICAL Â±2? activity PROPERTY MAINTAINED
```

ç°åœ¨ç”Ÿæˆæ–°çš„åŸ¹è®­å’Œè¯„ä¼°æ•°æ®ï¼š


```
src/training/tesstrain.sh --fonts_dir /usr/share/fonts --lang eng --linedata_only \
  --noextract_font_properties --langdata_dir ../langdata \
  --tessdata_dir ./tessdata --output_dir ~/tesstutorial/trainplusminus
src/training/tesstrain.sh --fonts_dir /usr/share/fonts --lang eng --linedata_only \
  --noextract_font_properties --langdata_dir ../langdata \
  --tessdata_dir ./tessdata \
  --fontlist "Impact Condensed" --output_dir ~/tesstutorial/evalplusminus
```

å¯¹æ–°çš„è®­ç»ƒæ•°æ®è¿›è¡Œå¾®è°ƒã€‚
è¿™éœ€è¦æ›´å¤šçš„è¿­ä»£

åªæœ‰ä¸€äº›æ–°ç›®æ ‡è§’è‰²çš„æ ·æœ¬å¯ä»¥ç»§ç»­ï¼š


```
training/combine_tessdata -e tessdata/best/eng.traineddata \
  ~/tesstutorial/trainplusminus/eng.lstm
training/lstmtraining --model_output ~/tesstutorial/trainplusminus/plusminus \
  --continue_from ~/tesstutorial/trainplusminus/eng.lstm \
  --traineddata ~/tesstutorial/trainplusminus/eng/eng.traineddata \
  --old_traineddata tessdata/best/eng.traineddata \
  --train_listfile ~/tesstutorial/trainplusminus/eng.training_files.txt \
  --max_iterations 3600
```

åœ¨100æ¬¡è¿­ä»£ä¹‹åï¼Œå®ƒå…·æœ‰1.26ï¼…/ 3.98ï¼…çš„å­—ç¬¦/å­—é”™è¯¯å¹¶ä¸”ä¸‹é™åˆ°

åœ¨3600æ—¶ä¸º0.041ï¼…/ 0.185ï¼…ã€‚å†æ¬¡ï¼Œç‹¬ç«‹æµ‹è¯•ç»™å‡ºäº†æ›´å¥½çš„ç»“æœï¼š


```
training/lstmeval --model ~/tesstutorial/trainplusminus/plusminus_checkpoint \
  --traineddata ~/tesstutorial/trainplusminus/eng/eng.traineddata \
  --eval_listfile ~/tesstutorial/trainplusminus/eng.training_files.txt
```

å­—ç¬¦é”™è¯¯0.0326ï¼…ï¼Œå­—0.128ï¼…ã€‚
æ›´æœ‰è¶£çš„æ˜¯ï¼Œæ˜¯å¦

æ–°çš„å­—ç¬¦å¯ä»¥åœ¨'Impact'å­—ä½“ä¸­è¯†åˆ«ï¼Œå› æ­¤è¿è¡Œæµ‹è¯•

å½±å“è¯„ä¼°é›†ï¼š


```
training/lstmeval --model ~/tesstutorial/trainplusminus/plusminus_checkpoint \
  --traineddata ~/tesstutorial/trainplusminus/eng/eng.traineddata \
  --eval_listfile ~/tesstutorial/evalplusminus/eng.training_files.txt
```

å­—ç¬¦é”™è¯¯ç‡= 2.3767074ï¼Œå­—é”™è¯¯ç‡= 8.3829474


è¿™ä¸åŸå§‹æ¨¡å‹çš„åŸå§‹æµ‹è¯•ç›¸æ¯”éå¸¸å¥½

å½±å“æ•°æ®é›†ã€‚
æ­¤å¤–ï¼Œå¦‚æœæ‚¨æ£€æŸ¥é”™è¯¯ï¼š


```
training/lstmeval --model ~/tesstutorial/trainplusminus/plusminus_checkpoint \
  --traineddata ~/tesstutorial/trainplusminus/eng/eng.traineddata \
  --eval_listfile ~/tesstutorial/evalplusminus/eng.training_files.txt 2>&1 |
  grep Â±
```

......ä½ åº”è¯¥çœ‹åˆ°æ‰€æœ‰çš„Â±ç¬¦å·éƒ½æ˜¯æ­£ç¡®çš„ï¼ 
(æ¯æ¡çœŸç›¸éƒ½æ˜¯å¦‚æ­¤

åŒ…å«Â±ä¹Ÿåœ¨ç›¸åº”çš„OCRçº¿ä¸ŠåŒ…å«Â±ï¼Œå¹¶ä¸”æ²¡æœ‰

åœ¨grepè¾“å‡ºä¸­æ²¡æœ‰åŒ¹é…çš„OCRè¡Œçš„çœŸå€¼è¡Œã€‚)


è¿™æ˜¯ä¸ªå¥½æ¶ˆæ¯ï¼
è¿™æ„å‘³ç€å¯ä»¥æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæ–°å­—ç¬¦

åœ¨ä¸å½±å“ç°æœ‰å‡†ç¡®æ€§çš„æƒ…å†µä¸‹ï¼Œ**å’Œ**èƒ½å¤Ÿè¯†åˆ«æ–°çš„å‡†ç¡®æ€§

è§’è‰²è‡³å°‘ä¼šåœ¨æŸç§ç¨‹åº¦ä¸Šæ¨å¹¿åˆ°å…¶ä»–å­—ä½“ï¼


æ³¨æ„ï¼šå¾®è°ƒæ—¶ï¼Œé‡è¦çš„æ˜¯è¦è¯•éªŒæ•°é‡

è¿­ä»£ï¼Œå› ä¸ºå¯¹å°æ•°æ®é›†çš„è¿‡åº¦è®­ç»ƒå°†å¯¼è‡´

è¿‡æ‹Ÿåˆã€‚ 
ADAMéå¸¸é€‚åˆæŸ¥æ‰¾å¿…è¦çš„åŠŸèƒ½ç»„åˆ

å¾—åˆ°é‚£ä¸ªç½•è§çš„ç±»æ˜¯æ­£ç¡®çš„ï¼Œä½†å®ƒç¡®å®ä¼¼ä¹è¿‡äºç®€å•

ä¼˜åŒ–ã€‚


###åŸ¹è®­å‡ ä¸ªå±‚æ¬¡


å¦‚æœæ‚¨åªæƒ³æ·»åŠ æ–°çš„å­—ä½“æ ·å¼æˆ–éœ€è¦å‡ ä¸ªå­—ä½“æ ·å¼ï¼Œåˆ™å¯ä»¥è¿›è¡Œå¾®è°ƒ

æ–°è§’è‰²ï¼Œä½†å¦‚æœä½ æƒ³ä¸ºå…‹æ—è´¡ç«è½¦æ€ä¹ˆåŠï¼Ÿ
ä½ ä¸å¤ªå¯èƒ½

æœ‰å¾ˆå¤šè®­ç»ƒæ•°æ®ï¼Œå®ƒä¸åŒäºå…¶ä»–ä»»ä½•ä¸œè¥¿ï¼Œæ‰€ä»¥ä½ åšä»€ä¹ˆï¼Ÿ
æ‚¨

å¯ä»¥å°è¯•åˆ é™¤ç°æœ‰ç½‘ç»œæ¨¡å‹çš„ä¸€äº›é¡¶å±‚ï¼Œæ›¿æ¢

å…¶ä¸­ä¸€äº›å…·æœ‰æ–°çš„éšæœºå±‚ï¼Œå¹¶è®­ç»ƒæ‚¨çš„æ•°æ®ã€‚
è¯¥

å‘½ä»¤è¡Œä¸[è®­ç»ƒæ¥è‡ª

åˆ®æ“¦](ï¼ƒtraining-from-scratch)ï¼Œä½†å¦å¤–ä½ å¿…é¡»æä¾›ä¸€ä¸ªæ¨¡å‹

`--continue_from`å’Œ`--append_index`ã€‚


`--append_index`å‚æ•°å‘Šè¯‰å®ƒåˆ é™¤**å±‚ä¸Šæ–¹çš„æ‰€æœ‰å±‚**

ä½¿ç”¨ç»™å®šçš„ç´¢å¼•(ä»é›¶å¼€å§‹ï¼Œåœ¨æœ€å¤–é¢çš„ç³»åˆ—ä¸­)ç„¶å

å°†ç»™å®šçš„`--net_spec`å‚æ•°é™„åŠ åˆ°å‰©ä¸‹çš„å†…å®¹ä¸­ã€‚
è™½ç„¶è¿™ä¸ªç´¢å¼•

ç³»ç»Ÿä¸æ˜¯å¼•ç”¨ç½‘ç»œå±‚çš„å®Œç¾æ–¹å¼ï¼Œè¿™æ˜¯ä¸€ä¸ªç»“æœ

å¤§å¤§ç®€åŒ–çš„ç½‘ç»œè§„èŒƒè¯­è¨€ã€‚
å»ºè®¾è€…ä¼š

è¾“å‡ºä¸å…¶ç”Ÿæˆçš„ç½‘ç»œç›¸å¯¹åº”çš„å­—ç¬¦ä¸²

åˆç†åœ°å®¹æ˜“æ£€æŸ¥ç´¢å¼•æ˜¯å¦æ¶‰åŠé¢„æœŸçš„å±‚ã€‚


4.00 alphaçš„ä¸€ä¸ªæ–°åŠŸèƒ½æ˜¯combine_tessdataå¯ä»¥åˆ—å‡ºaçš„å†…å®¹

traineddataæ–‡ä»¶åŠå…¶ç‰ˆæœ¬å­—ç¬¦ä¸²ã€‚
åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç‰ˆæœ¬å­—ç¬¦ä¸²

åŒ…æ‹¬ç”¨äºè®­ç»ƒçš„net_specï¼š


```
training/combine_tessdata -d tessdata/best/heb.traineddata
Version string:4.00.00alpha:heb:synth20170629:[1,36,0,1Ct3,3,16Mp3,3Lfys48Lfx96Lrx96Lfx192O1c1]
17:lstm:size=3022651, offset=192
18:lstm-punc-dawg:size=3022651, offset=3022843
19:lstm-word-dawg:size=673826, offset=3024221
20:lstm-number-dawg:size=625, offset=3698047
21:lstm-unicharset:size=1673826, offset=3703368
22:lstm-recoder:size=4023, offset=3703368
23:version:size=80, offset=3703993
```

å¹¶ä¸ºchi_simï¼š


```
training/combine_tessdata -d tessdata/best/chi_sim.traineddata
Version string:4.00.00alpha:chi_sim:synth20170629:[1,48,0,1Ct3,3,16Mp3,3Lfys64Lfx96Lrx96Lfx512O1c1]
0:config:size=1966, offset=192
17:lstm:size=12152851, offset=2158
18:lstm-punc-dawg:size=282, offset=12155009
19:lstm-word-dawg:size=590634, offset=12155291
20:lstm-number-dawg:size=82, offset=12745925
21:lstm-unicharset:size=258834, offset=12746007
22:lstm-recoder:size=72494, offset=13004841
23:version:size=84, offset=13077335
```

è¯·æ³¨æ„ï¼Œå±‚æ•°ç›¸åŒï¼Œä½†åªæœ‰å¤§å°ä¸åŒã€‚
å› æ­¤

åœ¨è¿™äº›æ¨¡å‹ä¸­ï¼Œ`--append_index`çš„ä»¥ä¸‹å€¼å°†ä¿ç•™

å…³è”çš„æœ€åä¸€å±‚ï¼Œå¹¶é™„åŠ åœ¨ä¸Šé¢ï¼š


**æŒ‡æ•°** | 
**å±‚**

ï¼š-------ï¼š| 
ï¼š-----------

`0` |
è¾“å…¥

`1` | 
`Ct3,3,16`

`2` | 
`Mp3,3`

`3` | 
`Lfys48 / 64`

`4` | 
`Lfx96`

`5` | 
`Lrx96`

`6` | 
`Lfx192 / 512`


ç°æœ‰æ¨¡å‹å‰©ä½™éƒ¨åˆ†çš„æƒé‡æœ€åˆä¿æŒä¸å˜ï¼Œ

ä½†å…è®¸é€šè¿‡æ–°çš„åŸ¹è®­æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚


ä¸¾ä¸ªä¾‹å­ï¼Œè®©æˆ‘ä»¬å°è¯•å°†ç°æœ‰çš„chi_simæ¨¡å‹è½¬æ¢ä¸ºengã€‚
æˆ‘ä»¬ä¼š

åˆ‡æ–­äº†æœ€åä¸€ä¸ªLSTMå±‚(å¯¹äºchi_simè€Œè¨€ï¼Œå®ƒæ¯”ä»¥å‰æ›´å¤§

è®­ç»ƒengæ¨¡å‹)å’Œsoftmaxï¼Œå–ä»£è¾ƒå°çš„LSTMå±‚å’Œa

æ–°çš„softmaxï¼š


```
mkdir -p ~/tesstutorial/eng_from_chi
training/combine_tessdata -e tessdata/best/chi_sim.traineddata \
  ~/tesstutorial/eng_from_chi/eng.lstm
training/lstmtraining --debug_interval 100 \
  --continue_from ~/tesstutorial/eng_from_chi/eng.lstm \
  --traineddata ~/tesstutorial/engtrain/eng/eng.traineddata \
  --append_index 5 --net_spec '[Lfx256 O1c111]' \
  --model_output ~/tesstutorial/eng_from_chi/base \
  --train_listfile ~/tesstutorial/engtrain/eng.training_files.txt \
  --eval_listfile ~/tesstutorial/engeval/eng.training_files.txt \
  --max_iterations 3000 &>~/tesstutorial/eng_from_chi/basetrain.log
```

ç”±äºè¾ƒä½å±‚å·²ç»è®­ç»ƒè¿‡ï¼Œå› æ­¤å­¦ä¹ é€Ÿåº¦è¦å¿«ä¸€äº›

ä»å¤´å¼€å§‹è®­ç»ƒã€‚
åœ¨600æ¬¡è¿­ä»£æ—¶ï¼Œå®ƒçªç„¶å¼€å§‹äº§ç”Ÿè¾“å‡º

åˆ°äº†800ï¼Œå®ƒå·²ç»è®©å¤§å¤šæ•°å­—ç¬¦æ­£ç¡®ã€‚
åˆ°å®ƒåœæ­¢çš„æ—¶å€™

åœ¨3000æ¬¡è¿­ä»£æ—¶ï¼Œå®ƒåº”è¯¥æ˜¯6.00ï¼…å­—ç¬¦/ 22.42ï¼…å­—ã€‚


å°è¯•å®Œæ•´è®­ç»ƒé›†çš„å¸¸è§„æµ‹è¯•ï¼š


```
training/lstmeval --model ~/tesstutorial/eng_from_chi/base_checkpoint \
  --traineddata ~/tesstutorial/engtrain/eng/eng.traineddata \
  --eval_listfile ~/tesstutorial/engtrain/eng.training_files.txt
```

å’Œ`Impact`å­—ä½“çš„ç‹¬ç«‹æµ‹è¯•ï¼š


```
training/lstmeval --model ~/tesstutorial/eng_from_chi/base_checkpoint \
  --traineddata ~/tesstutorial/engtrain/eng/eng.traineddata \
  --eval_listfile ~/tesstutorial/engeval/eng.training_files.txt
```

åœ¨å®Œæ•´çš„è®­ç»ƒé›†ä¸Šï¼Œæˆ‘ä»¬å¾—åˆ°5.557ï¼…/ 20.43ï¼…å’Œâ€œå½±å“â€36.67ï¼…/ 83.23ï¼…ï¼Œ

è¿™æ¯”ä»åˆ®åˆ®è®­ç»ƒè¦å¥½å¾—å¤šï¼Œä½†ä»ç„¶å¾ˆç³Ÿç³•

è¿‡åº¦æ‹Ÿåˆã€‚


æ€»ä¹‹ï¼Œå¯ä»¥åˆ‡æ–­ç°æœ‰ç½‘ç»œçš„é¡¶å±‚

ç«è½¦ï¼Œå¥½åƒä»å¤´å¼€å§‹ï¼Œä½†ä»æœ‰ç›¸å½“å¤šçš„è®­ç»ƒæ•°æ®

è¦æ±‚é¿å…è¿‡åº¦é…åˆã€‚


##æ¥è‡ªåŸ¹è®­çš„é”™è¯¯æ¶ˆæ¯


ä¸€äº›äººåœ¨è¿è¡ŒåŸ¹è®­æ—¶å¯èƒ½ä¼šå‡ºç°å„ç§é”™è¯¯æ¶ˆæ¯

å…¶ä¸­å¯èƒ½å¾ˆé‡è¦ï¼Œè€Œå…¶ä»–åˆ™ä¸æ˜¯å¾ˆé‡è¦ï¼š


`ç¼–ç å­—ç¬¦ä¸²å¤±è´¥ï¼`ç»“æœæ˜¯è®­ç»ƒå›¾åƒçš„æ–‡æœ¬å­—ç¬¦ä¸²

æ— æ³•ä½¿ç”¨ç»™å®šçš„unicharsetè¿›è¡Œç¼–ç ã€‚
å¯èƒ½çš„åŸå› æ˜¯ï¼š


æ–‡å­—ä¸­æœ‰ä¸€ä¸ªæ²¡æœ‰ä»£è¡¨æ€§çš„å­—ç¬¦ï¼Œæ¯”å¦‚è‹±é•‘ç¬¦å·
Â Â Â Â 
é‚£ä¸æ˜¯ä½ çš„unicharsetã€‚

1.æ–‡æœ¬ä¸­çš„ä¸€ä¸ªè¿·è·¯çš„ä¸å¯æ‰“å°å­—ç¬¦(å¦‚åˆ¶è¡¨ç¬¦æˆ–æ§åˆ¶å­—ç¬¦)ã€‚

1.æ¡ˆæ–‡ä¸­æ²¡æœ‰ä»£è¡¨æ€§çš„å°åº¦è¯­å­—ç´ /é˜¿å…‹è¨æ‹‰è¯­ã€‚


æ— è®ºå¦‚ä½•ï¼Œå®ƒå°†å¯¼è‡´è®­ç»ƒè€…å¿½ç•¥è®­ç»ƒå›¾åƒã€‚

å¦‚æœé”™è¯¯ä¸å¸¸è§ï¼Œåˆ™æ— å®³ï¼Œä½†å¯èƒ½è¡¨æ˜æ‚¨çš„é”™è¯¯

unicharsetä¸è¶³ä»¥ä»£è¡¨æ‚¨æ­£åœ¨è®­ç»ƒçš„è¯­è¨€ã€‚


`Unichar xxxå¤ªé•¿ï¼Œä¸èƒ½ç¼–ç ï¼`(å¾ˆå¯èƒ½åªæ˜¯å°åº¦è¯­)ã€‚
æœ‰ä¸€ä¸ª

å¯ä»¥åœ¨é‡æ–°ç¼–ç å™¨ä¸­ä½¿ç”¨çš„unicodeå­—ç¬¦é•¿åº¦çš„ä¸Šé™ï¼Œ

è¿™ç®€åŒ–äº†LSTMå¼•æ“çš„unicharsetã€‚
å®ƒä¼šç»§ç»­ä¸‹å»

æŠŠAksaraä»å¯è¯†åˆ«çš„é›†åˆä¸­åˆ é™¤ï¼Œä½†å¦‚æœæœ‰å¾ˆå¤šï¼Œé‚£ä¹ˆä½ 

æœ‰éº»çƒ¦äº†ã€‚


`boxfileå­—ç¬¦ä¸²ä¸­çš„åæ¡†åæ ‡ï¼`LSTMåŸ¹è®­å¸ˆåªéœ€è¦è¾¹ç•Œ

å®Œæ•´æ–‡æœ¬è¡Œçš„æ¡†ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å­—ç¬¦çº§åˆ«ï¼Œä½†æ˜¯å¦‚æœ

ä½ åœ¨æ¡†å­—ç¬¦ä¸²ä¸­æ”¾ç½®ç©ºæ ¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š


```
<text for line including spaces> <left> <bottom> <right> <top> <page>
```

è§£æå™¨ä¼šæ··æ·†å¹¶ç»™ä½ é”™è¯¯ä¿¡æ¯ã€‚


å½“è®­ç»ƒè¾“å…¥ä¸æ˜¯LSTMæ ¼å¼æ—¶ï¼Œä¼šå‘ç”Ÿâ€œååºåˆ—åŒ–æ ‡é¢˜å¤±è´¥â€

æˆ–è€…æ–‡ä»¶ä¸å¯è¯»ã€‚
æ£€æŸ¥æ‚¨çš„æ–‡ä»¶åˆ—è¡¨æ–‡ä»¶ä»¥æŸ¥çœ‹å®ƒæ˜¯å¦åŒ…å«

æœ‰æ•ˆçš„æ–‡ä»¶åã€‚


`æ²¡æœ‰å—é‡å çš„æ–‡æœ¬è¡Œï¼š`å½“å¸ƒå±€åˆ†ææ— æ³•æ­£ç¡®æ—¶å‡ºç°

åˆ†å‰²ä½œä¸ºè®­ç»ƒæ•°æ®ç»™å‡ºçš„å›¾åƒã€‚
æ–‡æœ¬è¡Œè¢«åˆ é™¤ã€‚
ä¸

å¦‚æœæ²¡æœ‰å¾ˆå¤šé—®é¢˜ï¼Œä½†å¦‚æœæœ‰å¾ˆå¤šé—®é¢˜ï¼Œå¯èƒ½ä¼šæœ‰å¾ˆå¤šé—®é¢˜

è®­ç»ƒæ–‡æœ¬æˆ–æ¸²æŸ“è¿‡ç¨‹æœ‰é—®é¢˜ã€‚


`<Undecodable>`å¯ä»¥åœ¨æ—©æœŸçš„ALIGNED_TRUTHæˆ–OCR TEXTè¾“å‡ºä¸­å‡ºç°

åœ¨åŸ¹è®­ä¸­ã€‚
è¿™æ˜¯unicharsetå‹ç¼©å’ŒCTCè®­ç»ƒçš„ç»“æœã€‚

(å‚è§ä¸Šé¢çš„Unicharset Compressionå’Œtrain_mode)ã€‚
è¿™åº”è¯¥æ˜¯æ— å®³çš„

å¯ä»¥å®‰å…¨åœ°å¿½ç•¥ã€‚
éšç€è®­ç»ƒçš„è¿›è¡Œï¼Œå®ƒçš„é¢‘ç‡åº”è¯¥ä¸‹é™ã€‚


ï¼ƒç»„åˆè¾“å‡ºæ–‡ä»¶


lstmtrainingç¨‹åºè¾“å‡ºä¸¤ç§æ£€æŸ¥ç‚¹æ–‡ä»¶ï¼š


*`<model_base> _checkpoint`æ˜¯æœ€æ–°çš„æ¨¡å‹æ–‡ä»¶ã€‚

*`<model_base> <char_error> _ <iteration> .checkpoint`å®šæœŸå†™ä¸º
Â Â Â Â 
å…·æœ‰æœ€ä½³è®­ç»ƒè¯¯å·®çš„æ¨¡å‹ã€‚
è¿™æ˜¯ä¸€ä¸ªè®­ç»ƒè½¬å‚¨å°±åƒ
Â Â Â Â 
æ£€æŸ¥ç‚¹ï¼Œä½†è¾ƒå°ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è¦ä½¿ç”¨çš„å¤‡ä»½æ¨¡å‹
Â Â Â Â 
å¦‚æœè®­ç»ƒå‘ç”Ÿåˆ†æ­§ã€‚


è¿™äº›æ–‡ä»¶ä¸­çš„ä»»ä½•ä¸€ä¸ªéƒ½å¯ä»¥è½¬æ¢ä¸ºæ ‡å‡†çš„è®­ç»ƒæ•°æ®æ–‡ä»¶

å¦‚ä¸‹ï¼š


```
training/lstmtraining --stop_training \
  --continue_from ~/tesstutorial/eng_from_chi/base_checkpoint \
  --traineddata ~/tesstutorial/engtrain/eng/eng.traineddata \
  --model_output ~/tesstutorial/eng_from_chi/eng.traineddata
```

è¿™å°†ä»è®­ç»ƒè½¬å‚¨ä¸­æå–è¯†åˆ«æ¨¡å‹ï¼Œå¹¶å°†å…¶æ’å…¥

è¿›å…¥--traineddataè®ºè¯ï¼Œä»¥åŠunicharsetï¼Œé‡æ–°ç¼–ç å’Œä»»ä½•

åœ¨è®­ç»ƒæœŸé—´æä¾›çš„dawgsã€‚


**æ³¨æ„** Tesseract 4.00ç°åœ¨å¯ä»¥ä½¿ç”¨è®­ç»ƒæœ‰ç´ çš„æ•°æ®æ–‡ä»¶å¿«ä¹åœ°è¿è¡Œ

åŒ…å«* just *`lang.lstm`ï¼Œ`lang.lstm-unicharset`å’Œ`lang.lstm-recoder`ã€‚
è¯¥

`lstm  -  *  -  dawgs`æ˜¯å¯é€‰çš„ï¼Œ*ä¸éœ€è¦å…¶ä»–ç»„ä»¶æˆ–

ä¸OEM_LSTM_ONLYä¸€èµ·ç”¨ä½œOCRå¼•æ“æ¨¡å¼ã€‚*æ²¡æœ‰bigramsï¼Œunichar ambigsæˆ–

å¦‚æœå­˜åœ¨ï¼Œåˆ™éœ€è¦ä»»ä½•å…¶ä»–ç»„ä»¶æˆ–ç”šè‡³å…·æœ‰ä»»ä½•æ•ˆæœã€‚
è¯¥

åªåšå…¶ä»–äº‹æƒ…çš„ç»„ä»¶æ˜¯`lang.config`ï¼Œå®ƒå¯ä»¥å½±å“

å¸ƒå±€åˆ†æå’Œå­è¯­è¨€ã€‚


å¦‚æœæ·»åŠ åˆ°ç°æœ‰çš„Tesseract traineddataæ–‡ä»¶ä¸­ï¼Œåˆ™ä¸ºâ€œlstm-unicharsetâ€

ä¸å¿…åŒ¹é…Tesseract`unicharset`ï¼Œä½†åŒæ ·çš„unicharsetå¿…é¡»

ç”¨äºè®­ç»ƒLSTMå¹¶æ„å»º`lstm  -  *  -  dawgs`æ–‡ä»¶ã€‚


ï¼ƒå¹»è§‰æ•ˆåº”


å¦‚æœæ‚¨å‘ç°æ‚¨çš„æ¨¡å‹è¡Œä¸ºä¸ç«¯ï¼Œä¾‹å¦‚ï¼š

*åœ¨æŸäº›å•è¯çš„å¼€å¤´æ·»åŠ â€œCapitalâ€å­—æ¯è€Œä¸æ˜¯â€œSmallâ€å­—æ¯ã€‚

*æ·»åŠ â€œç©ºé—´â€ä¸åº”è¯¥è¿™æ ·åšã€‚

*ç­‰......


[ç„¶åé˜…è¯»å¹»è§‰è¯é¢˜ã€‚](https://github.com/tesseract-ocr/tesseract/wiki/The-Hallucination-Effect)


